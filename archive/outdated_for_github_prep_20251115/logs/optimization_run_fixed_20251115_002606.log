2025-11-15 00:26:57,768 - INFO - ✓ GPU libraries (cuML) available - will use GPU for UMAP/HDBSCAN
2025-11-15 00:26:57,782 - INFO - ================================================================================
2025-11-15 00:26:57,782 - INFO - BERTopic + OCTIS Optimization for Reviews Corpus
2025-11-15 00:26:57,782 - INFO - ================================================================================
2025-11-15 00:26:57,783 - INFO - 
Memory Optimization Settings:
2025-11-15 00:26:57,783 - INFO -   Embedding batch size: 16
2025-11-15 00:26:57,783 - INFO -   Optimization multiplier: 15
2025-11-15 00:26:57,783 - INFO -   Process one model at a time: False
2025-11-15 00:26:57,783 - INFO - 
[STEP 1] Loading configuration...
2025-11-15 00:26:57,783 - INFO - Loading configuration from: src/reviews_analysis/BERTopic_OCTIS/config_bertopic_reviews.yaml
2025-11-15 00:26:57,804 - INFO - ✓ Configuration loaded successfully
2025-11-15 00:26:57,804 - INFO -   Configuration loaded: 12 parameter groups
2025-11-15 00:26:57,804 - INFO -   Available parameters: embedding_model, top_n_words, n_gram_range, min_topic_size, nr_topics, low_memory, umap_n_neighbors, umap_n_components, umap_metric, hdbscan_min_cluster_size, hdbscan_min_samples, hdbscan_metric
2025-11-15 00:26:57,804 - INFO - 
[STEP 2] Loading dataset...
2025-11-15 00:26:57,805 - INFO -   Checking for test dataset: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/review_sentences_test_10k.parquet
2025-11-15 00:26:57,805 - INFO - Found test dataset: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/review_sentences_test_10k.parquet
2025-11-15 00:26:57,805 - INFO -   Loading from test parquet (for quick testing)
2025-11-15 00:26:57,805 - WARNING -   NOTE: Test dataset may have cleaned text. For production, use raw text from reviews.
2025-11-15 00:26:57,807 - INFO - Loading sentences from parquet: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/review_sentences_test_10k.parquet
2025-11-15 00:26:57,926 - INFO -   Loaded 9,999 sentences
2025-11-15 00:26:57,926 - INFO -   ✓ Loaded 9,999 raw sentences
2025-11-15 00:26:57,926 - INFO -   Columns: ['sentence_id', 'sentence_text', 'review_id', 'work_id', 'pop_tier', 'rating', 'sentence_index', 'n_sentences_in_review']
2025-11-15 00:26:57,926 - INFO - 
  Pop tier distribution:
2025-11-15 00:26:57,932 - INFO -     mid: 3,333 (33.3%)
2025-11-15 00:26:57,933 - INFO -     thrash: 3,333 (33.3%)
2025-11-15 00:26:57,933 - INFO -     top: 3,333 (33.3%)
2025-11-15 00:26:57,933 - INFO - 
[STEP 3] Preparing dataset for embeddings and coherence...
2025-11-15 00:26:57,934 - INFO -   Total sentences for embeddings: 9,999
2025-11-15 00:26:57,938 - INFO -   Metadata columns stored: ['sentence_id', 'review_id', 'work_id', 'pop_tier', 'rating']
2025-11-15 00:26:58,003 - INFO -   Prepared 9,999 sentences for coherence calculation
2025-11-15 00:26:58,003 - INFO - 
[STEP 4] Preparing OCTIS dataset format...
2025-11-15 00:26:58,004 - INFO -   OCTIS dataset path: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews
2025-11-15 00:26:58,004 - INFO -   Creating OCTIS corpus.tsv file...
2025-11-15 00:26:59,620 - INFO -   Writing 9,999 rows to TSV...
2025-11-15 00:26:59,704 - INFO -   ✓ Created OCTIS corpus: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/corpus.tsv
2025-11-15 00:26:59,704 - INFO -   Total sentences: 9,999
2025-11-15 00:26:59,704 - INFO -   Label format: work_id (book-level)
2025-11-15 00:26:59,704 - INFO -   Loading OCTIS dataset...
2025-11-15 00:26:59,938 - INFO -   ✓ OCTIS dataset loaded successfully
2025-11-15 00:27:01,880 - INFO - 
[STEP 5] Loading embedding models...
2025-11-15 00:27:01,880 - INFO -   Using 4 embedding models from config:
2025-11-15 00:27:01,881 - INFO -     1. sentence-transformers/paraphrase-mpnet-base-v2
2025-11-15 00:27:01,881 - INFO -     2. sentence-transformers/multi-qa-mpnet-base-cos-v1
2025-11-15 00:27:01,881 - INFO -     3. intfloat/e5-base-v2
2025-11-15 00:27:01,881 - INFO -     4. thenlper/gte-large
2025-11-15 00:27:01,881 - INFO - 
  Determining compute device...
2025-11-15 00:27:01,887 - INFO -   ✓ Using GPU device: NVIDIA GeForce RTX 2070 with Max-Q Design
2025-11-15 00:27:01,887 - INFO -   GPU memory: 8.2 GB
2025-11-15 00:27:01,888 - INFO - 
  Loading 4 embedding model(s)...
2025-11-15 00:27:01,888 - INFO -   [1/4] Loading: sentence-transformers/paraphrase-mpnet-base-v2
2025-11-15 00:27:01,888 - INFO -     Device: cuda
2025-11-15 00:27:01,889 - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-mpnet-base-v2
2025-11-15 00:27:04,870 - INFO -     ✓ Model loaded in 2.98 seconds
2025-11-15 00:27:04,871 - INFO -   [2/4] Loading: sentence-transformers/multi-qa-mpnet-base-cos-v1
2025-11-15 00:27:04,872 - INFO -     Device: cuda
2025-11-15 00:27:04,873 - INFO - Load pretrained SentenceTransformer: sentence-transformers/multi-qa-mpnet-base-cos-v1
2025-11-15 00:27:07,502 - INFO -     ✓ Model loaded in 2.63 seconds
2025-11-15 00:27:07,502 - INFO -   [3/4] Loading: intfloat/e5-base-v2
2025-11-15 00:27:07,503 - INFO -     Device: cuda
2025-11-15 00:27:07,505 - INFO - Load pretrained SentenceTransformer: intfloat/e5-base-v2
2025-11-15 00:27:10,470 - INFO -     ✓ Model loaded in 2.97 seconds
2025-11-15 00:27:10,470 - INFO -   [4/4] Loading: thenlper/gte-large
2025-11-15 00:27:10,471 - INFO -     Device: cuda
2025-11-15 00:27:10,473 - INFO - Load pretrained SentenceTransformer: thenlper/gte-large
2025-11-15 00:27:15,198 - INFO -     ✓ Model loaded in 4.73 seconds
2025-11-15 00:27:15,198 - INFO - 
[STEP 6] Calculating/loading embeddings...
2025-11-15 00:27:15,199 - INFO -   Using raw, unpreprocessed text for embeddings
2025-11-15 00:27:15,199 - INFO -   Number of sentences: 9,999
2025-11-15 00:27:15,199 - INFO -   Embedding models to process: 4
2025-11-15 00:27:15,199 - INFO -   Embedding storage directory: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews
2025-11-15 00:27:15,200 - INFO -   Pre-loading all embeddings (standard mode)...
2025-11-15 00:27:15,200 - INFO - 
  [1/4] Processing: sentence-transformers/paraphrase-mpnet-base-v2
2025-11-15 00:27:15,200 - INFO -     Embedding file path: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/embeddings_sentence-transformers_paraphrase-mpnet-base-v2.pkl
2025-11-15 00:27:15,201 - INFO -     Found existing embeddings file
2025-11-15 00:27:15,201 - INFO -     Loading embeddings from: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/embeddings_sentence-transformers_paraphrase-mpnet-base-v2.pkl
2025-11-15 00:27:15,201 - INFO -     File size: 29.3 MB
2025-11-15 00:27:15,266 - INFO -     ✓ Embeddings loaded in 0.06 seconds
2025-11-15 00:27:15,266 - INFO -     Embedding shape: (9999, 768)
2025-11-15 00:27:15,266 - INFO -     Embedding dtype: float32
2025-11-15 00:27:15,267 - INFO - 
  [2/4] Processing: sentence-transformers/multi-qa-mpnet-base-cos-v1
2025-11-15 00:27:15,267 - INFO -     Embedding file path: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/embeddings_sentence-transformers_multi-qa-mpnet-base-cos-v1.pkl
2025-11-15 00:27:15,267 - INFO -     Found existing embeddings file
2025-11-15 00:27:15,267 - INFO -     Loading embeddings from: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/embeddings_sentence-transformers_multi-qa-mpnet-base-cos-v1.pkl
2025-11-15 00:27:15,268 - INFO -     File size: 29.3 MB
2025-11-15 00:27:15,326 - INFO -     ✓ Embeddings loaded in 0.06 seconds
2025-11-15 00:27:15,327 - INFO -     Embedding shape: (9999, 768)
2025-11-15 00:27:15,327 - INFO -     Embedding dtype: float32
2025-11-15 00:27:15,328 - INFO - 
  [3/4] Processing: intfloat/e5-base-v2
2025-11-15 00:27:15,328 - INFO -     Embedding file path: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/embeddings_intfloat_e5-base-v2.pkl
2025-11-15 00:27:15,328 - INFO -     Found existing embeddings file
2025-11-15 00:27:15,329 - INFO -     Loading embeddings from: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/embeddings_intfloat_e5-base-v2.pkl
2025-11-15 00:27:15,329 - INFO -     File size: 29.3 MB
2025-11-15 00:27:15,387 - INFO -     ✓ Embeddings loaded in 0.06 seconds
2025-11-15 00:27:15,388 - INFO -     Embedding shape: (9999, 768)
2025-11-15 00:27:15,388 - INFO -     Embedding dtype: float32
2025-11-15 00:27:15,388 - INFO - 
  [4/4] Processing: thenlper/gte-large
2025-11-15 00:27:15,389 - INFO -     Embedding file path: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/embeddings_thenlper_gte-large.pkl
2025-11-15 00:27:15,389 - INFO -     Found existing embeddings file
2025-11-15 00:27:15,390 - INFO -     Loading embeddings from: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/embeddings_thenlper_gte-large.pkl
2025-11-15 00:27:15,390 - INFO -     File size: 39.1 MB
2025-11-15 00:27:15,469 - INFO -     ✓ Embeddings loaded in 0.08 seconds
2025-11-15 00:27:15,470 - INFO -     Embedding shape: (9999, 1024)
2025-11-15 00:27:15,470 - INFO -     Embedding dtype: float32
2025-11-15 00:27:15,470 - INFO - 
[STEP 8] Starting optimization for all embedding models...
2025-11-15 00:27:15,470 - INFO -   Total embedding models to optimize: 4
2025-11-15 00:27:15,470 - INFO - 
================================================================================
2025-11-15 00:27:15,471 - INFO - Processing embedding model 1/4: sentence-transformers/paraphrase-mpnet-base-v2
2025-11-15 00:27:15,471 - INFO - ================================================================================
2025-11-15 00:27:15,471 - INFO -   Instantiating BERTopicOctisModelWithEmbeddings...
2025-11-15 00:27:15,471 - INFO -   ✓ Model instance created
2025-11-15 00:27:15,471 - INFO -   Starting hyperparameter optimization for sentence-transformers/paraphrase-mpnet-base-v2...
2025-11-15 00:27:15,471 - INFO - 
[STEP 7] Setting up hyperparameter optimization for: sentence-transformers/paraphrase-mpnet-base-v2
2025-11-15 00:27:15,472 - INFO -   Building search space from configuration...
2025-11-15 00:27:15,472 - INFO - Building search space from configuration...
2025-11-15 00:27:15,475 - INFO -   umap__n_neighbors: Integer(10, 100)
2025-11-15 00:27:15,478 - INFO -   umap__n_components: Integer(2, 20)
2025-11-15 00:27:15,484 - INFO -   umap__metric: Categorical(2 values)
2025-11-15 00:27:15,487 - INFO -   hdbscan__min_cluster_size: Integer(20, 300)
2025-11-15 00:27:15,490 - INFO -   hdbscan__min_samples: Integer(5, 300)
2025-11-15 00:27:15,495 - INFO -   hdbscan__metric: Categorical(2 values)
2025-11-15 00:27:15,497 - INFO -   bertopic__top_n_words: Integer(8, 25)
2025-11-15 00:27:15,502 - INFO -   bertopic__n_gram_range: Categorical(3 values) - stored as strings, will convert to tuples
2025-11-15 00:27:15,506 - INFO -   bertopic__min_topic_size: Integer(50, 500)
2025-11-15 00:27:15,509 - INFO -   bertopic__nr_topics: Integer(200, 1000)
2025-11-15 00:27:15,514 - INFO -   bertopic__low_memory: Categorical(2 values)
2025-11-15 00:27:15,517 - INFO -   vectorizer__min_df: Real(0.001, 0.01) [default]
2025-11-15 00:27:15,517 - INFO - ✓ Search space built with 12 parameters
2025-11-15 00:27:15,518 - INFO -   Search space contains 12 parameters:
2025-11-15 00:27:15,518 - INFO -     - bertopic__low_memory
2025-11-15 00:27:15,518 - INFO -     - bertopic__min_topic_size
2025-11-15 00:27:15,518 - INFO -     - bertopic__n_gram_range
2025-11-15 00:27:15,518 - INFO -     - bertopic__nr_topics
2025-11-15 00:27:15,518 - INFO -     - bertopic__top_n_words
2025-11-15 00:27:15,518 - INFO -     - hdbscan__metric
2025-11-15 00:27:15,519 - INFO -     - hdbscan__min_cluster_size
2025-11-15 00:27:15,519 - INFO -     - hdbscan__min_samples
2025-11-15 00:27:15,519 - INFO -     - umap__metric
2025-11-15 00:27:15,519 - INFO -     - umap__n_components
2025-11-15 00:27:15,519 - INFO -     - umap__n_neighbors
2025-11-15 00:27:15,519 - INFO -     - vectorizer__min_df
2025-11-15 00:27:15,520 - INFO -   Optimization runs: 180 (15 × 12 parameters)
2025-11-15 00:27:15,520 - INFO -   Model runs per configuration: 1
2025-11-15 00:27:15,520 - INFO -   Top-k for metrics: 10
2025-11-15 00:27:15,521 - INFO -   Filtering empty documents for coherence calculation...
2025-11-15 00:27:15,524 - INFO -   Documents for coherence: 9,999
2025-11-15 00:27:15,524 - INFO -   Initializing evaluation metrics...
2025-11-15 00:27:15,524 - INFO -     Coherence metric: c_v (topk=10)
2025-11-15 00:27:15,525 - INFO - adding document #0 to Dictionary<0 unique tokens: []>
2025-11-15 00:27:16,566 - INFO - built Dictionary<18815 unique tokens: ['be', 'higher.', 'rating', 'should', 'the']...> from 9999 documents (total 157174 corpus positions)
2025-11-15 00:27:16,577 - INFO - Dictionary lifecycle event {'msg': "built Dictionary<18815 unique tokens: ['be', 'higher.', 'rating', 'should', 'the']...> from 9999 documents (total 157174 corpus positions)", 'datetime': '2025-11-15T00:27:16.567848', 'gensim': '4.4.0', 'python': '3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]', 'platform': 'Linux-6.14.0-115036-tuxedo-x86_64-with-glibc2.39', 'event': 'created'}
2025-11-15 00:27:16,577 - INFO -     Diversity metric: TopicDiversity (topk=10)
2025-11-15 00:27:16,577 - INFO -   ✓ Metrics initialized
2025-11-15 00:27:16,577 - INFO -   Creating optimizer instance...
2025-11-15 00:27:16,577 - INFO -   ✓ Optimizer created
2025-11-15 00:27:16,578 - INFO -   Results path: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/
2025-11-15 00:27:16,578 - INFO -   Result file: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/result.json
2025-11-15 00:27:16,578 - INFO - 
  No existing results found
2025-11-15 00:27:16,578 - INFO -   Starting new optimization
2025-11-15 00:27:16,579 - INFO -   Results will be saved to: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/
2025-11-15 00:27:16,579 - INFO -   Optimization settings:
2025-11-15 00:27:16,579 - INFO -     - Number of calls: 180
2025-11-15 00:27:16,579 - INFO -     - Model runs per config: 1
2025-11-15 00:27:16,579 - INFO -     - Primary metric: Coherence (c_v)
2025-11-15 00:27:16,579 - INFO -     - Extra metrics: TopicDiversity
2025-11-15 00:27:16,580 - INFO -     - Save models: True
2025-11-15 00:27:16,714 - INFO - 
================================================================================
2025-11-15 00:27:16,714 - INFO - Training #1
2025-11-15 00:27:16,714 - INFO - Embedding model: sentence-transformers/paraphrase-mpnet-base-v2
2025-11-15 00:27:16,715 - INFO - ================================================================================
2025-11-15 00:27:16,715 - INFO - Results directory: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2
2025-11-15 00:27:16,715 - INFO - Results file: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/result.json
2025-11-15 00:27:16,716 - INFO - Results CSV: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/results.csv
2025-11-15 00:27:16,716 - INFO - 
[Training] Setting hyperparameters...
2025-11-15 00:27:16,716 - INFO -   Received 12 hyperparameters from optimizer
2025-11-15 00:27:16,717 - INFO -   Hyperparameters after merging:
2025-11-15 00:27:16,717 - INFO -     umap:
2025-11-15 00:27:16,717 - INFO -       n_neighbors: 87
2025-11-15 00:27:16,717 - INFO -       n_components: 16
2025-11-15 00:27:16,718 - INFO -       min_dist: 0.05
2025-11-15 00:27:16,718 - INFO -       metric: l2
2025-11-15 00:27:16,718 - INFO -       random_state: 42
2025-11-15 00:27:16,718 - INFO -     hdbscan:
2025-11-15 00:27:16,718 - INFO -       min_cluster_size: 71
2025-11-15 00:27:16,719 - INFO -       metric: l2
2025-11-15 00:27:16,719 - INFO -       cluster_selection_method: eom
2025-11-15 00:27:16,719 - INFO -       prediction_data: True
2025-11-15 00:27:16,719 - INFO -       gen_min_span_tree: True
2025-11-15 00:27:16,720 - INFO -       min_samples: 212
2025-11-15 00:27:16,720 - INFO -     vectorizer:
2025-11-15 00:27:16,720 - INFO -       stop_words: english
2025-11-15 00:27:16,720 - INFO -       min_df: 0.0056575194569230425
2025-11-15 00:27:16,721 - INFO -       ngram_range: (1, 1)
2025-11-15 00:27:16,721 - INFO -     tfdf_vectorizer:
2025-11-15 00:27:16,721 - INFO -       reduce_frequent_words: True
2025-11-15 00:27:16,721 - INFO -       bm25_weighting: True
2025-11-15 00:27:16,722 - INFO -     bertopic:
2025-11-15 00:27:16,722 - INFO -       language: english
2025-11-15 00:27:16,722 - INFO -       top_n_words: 18
2025-11-15 00:27:16,722 - INFO -       n_gram_range: (1, 3)
2025-11-15 00:27:16,722 - INFO -       min_topic_size: 359
2025-11-15 00:27:16,723 - INFO -       nr_topics: 356
2025-11-15 00:27:16,723 - INFO -       low_memory: False
2025-11-15 00:27:16,723 - INFO -       calculate_probabilities: True
2025-11-15 00:27:16,723 - INFO -       verbose: True
2025-11-15 00:27:16,723 - WARNING -   ⚠ Constraint violation: min_samples (212) > min_cluster_size (71)
2025-11-15 00:27:16,723 - INFO -   Enforcing constraint: setting min_samples = min_cluster_size = 71
2025-11-15 00:27:16,724 - INFO -   ✓ Constraint enforced
2025-11-15 00:27:16,725 - INFO - 
[Training] Initializing pipeline components...
2025-11-15 00:27:16,726 - INFO -   Creating UMAP model...
2025-11-15 00:27:16,726 - INFO -     Parameters: {'n_neighbors': 87, 'n_components': 16, 'min_dist': 0.05, 'metric': 'l2', 'random_state': 42}
2025-11-15 00:27:16,726 - INFO -     Using GPU version (cuML)
2025-11-15 00:27:16,732 - INFO -     ✓ UMAP model created
2025-11-15 00:27:16,733 - INFO -   Creating HDBSCAN model...
2025-11-15 00:27:16,733 - INFO -     Parameters: {'min_cluster_size': 71, 'metric': 'l2', 'cluster_selection_method': 'eom', 'prediction_data': True, 'gen_min_span_tree': True, 'min_samples': 71}
2025-11-15 00:27:16,733 - INFO -     Using GPU version (cuML)
2025-11-15 00:27:16,733 - INFO -     ✓ HDBSCAN model created
2025-11-15 00:27:16,734 - INFO -   Creating CountVectorizer...
2025-11-15 00:27:16,734 - INFO -     Parameters: {'stop_words': 'english', 'min_df': 0.0056575194569230425, 'ngram_range': (1, 1)}
2025-11-15 00:27:16,734 - INFO -     ✓ CountVectorizer created
2025-11-15 00:27:16,734 - INFO -   Creating ClassTfidfTransformer...
2025-11-15 00:27:16,734 - INFO -     Parameters: {'reduce_frequent_words': True, 'bm25_weighting': True}
2025-11-15 00:27:16,734 - INFO -     ✓ ClassTfidfTransformer created
2025-11-15 00:27:16,735 - INFO -   Creating BERTopic model...
2025-11-15 00:27:16,735 - INFO -     BERTopic parameters: {'language': 'english', 'top_n_words': 18, 'n_gram_range': (1, 3), 'min_topic_size': 359, 'nr_topics': 356, 'low_memory': False, 'calculate_probabilities': True, 'verbose': True}
2025-11-15 00:27:16,736 - INFO -     ✓ BERTopic model created
2025-11-15 00:27:16,736 - INFO - 
[Training] Fitting BERTopic model...
2025-11-15 00:27:16,736 - INFO -   Dataset size: 9,999 sentences
2025-11-15 00:27:16,736 - INFO -   Embeddings shape: (9999, 768)
2025-11-15 00:27:16,736 - INFO -   Starting fit_transform...
2025-11-15 00:27:16,758 - BERTopic - Dimensionality - Fitting the dimensionality reduction algorithm
2025-11-15 00:27:18,723 - BERTopic - Dimensionality - Completed ✓
2025-11-15 00:27:18,725 - BERTopic - Cluster - Start clustering the reduced embeddings
2025-11-15 00:27:19,855 - BERTopic - Cluster - Completed ✓
2025-11-15 00:27:19,856 - BERTopic - Representation - Extracting topics using c-TF-IDF for topic reduction.
2025-11-15 00:27:20,629 - BERTopic - Representation - Completed ✓
2025-11-15 00:27:20,630 - BERTopic - Topic reduction - Reducing number of topics
2025-11-15 00:27:20,630 - BERTopic - Topic reduction - Number of topics (356) is equal or higher than the clustered topics(12).
2025-11-15 00:27:20,630 - BERTopic - Representation - Fine-tuning topics using representation models.
2025-11-15 00:28:03,710 - BERTopic - Representation - Completed ✓
2025-11-15 00:28:04,150 - INFO -   ✓ Model fitted in 47.4 seconds (0.79 minutes)
2025-11-15 00:28:04,151 - INFO - 
[Training] Analyzing topic assignments...
2025-11-15 00:28:04,154 - INFO -   Total topic assignments: 9,999
2025-11-15 00:28:04,154 - INFO -   Unique topics (including outliers): 12
2025-11-15 00:28:04,155 - INFO -   Number of topics (excluding outliers): 11
2025-11-15 00:28:04,155 - INFO -   Number of outliers (topic -1): 6,435 (64.4%)
2025-11-15 00:28:04,156 - INFO -   Checking topic count threshold (minimum: 200)...
2025-11-15 00:28:04,156 - WARNING -   ⚠ Model rejected: Only 11 topics found (minimum required: 200)
2025-11-15 00:28:04,157 - INFO -   Rejection reason: Topic count 11 < 200
2025-11-15 00:28:08,466 - INFO - 
================================================================================
2025-11-15 00:28:08,467 - INFO - Training #2
2025-11-15 00:28:08,467 - INFO - Embedding model: sentence-transformers/paraphrase-mpnet-base-v2
2025-11-15 00:28:08,467 - INFO - ================================================================================
2025-11-15 00:28:08,468 - INFO - Results directory: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2
2025-11-15 00:28:08,468 - INFO - Results file: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/result.json
2025-11-15 00:28:08,468 - INFO - Results CSV: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/results.csv
2025-11-15 00:28:08,469 - INFO - 
[Training] Setting hyperparameters...
2025-11-15 00:28:08,469 - INFO -   Received 12 hyperparameters from optimizer
2025-11-15 00:28:08,470 - INFO -   Hyperparameters after merging:
2025-11-15 00:28:08,470 - INFO -     umap:
2025-11-15 00:28:08,470 - INFO -       n_neighbors: 87
2025-11-15 00:28:08,470 - INFO -       n_components: 16
2025-11-15 00:28:08,470 - INFO -       min_dist: 0.05
2025-11-15 00:28:08,471 - INFO -       metric: l2
2025-11-15 00:28:08,471 - INFO -       random_state: 42
2025-11-15 00:28:08,471 - INFO -     hdbscan:
2025-11-15 00:28:08,471 - INFO -       min_cluster_size: 92
2025-11-15 00:28:08,471 - INFO -       metric: euclidean
2025-11-15 00:28:08,471 - INFO -       cluster_selection_method: eom
2025-11-15 00:28:08,471 - INFO -       prediction_data: True
2025-11-15 00:28:08,472 - INFO -       gen_min_span_tree: True
2025-11-15 00:28:08,472 - INFO -       min_samples: 54
2025-11-15 00:28:08,472 - INFO -     vectorizer:
2025-11-15 00:28:08,472 - INFO -       stop_words: english
2025-11-15 00:28:08,472 - INFO -       min_df: 0.006640909998578003
2025-11-15 00:28:08,472 - INFO -       ngram_range: (1, 1)
2025-11-15 00:28:08,473 - INFO -     tfdf_vectorizer:
2025-11-15 00:28:08,473 - INFO -       reduce_frequent_words: True
2025-11-15 00:28:08,473 - INFO -       bm25_weighting: True
2025-11-15 00:28:08,473 - INFO -     bertopic:
2025-11-15 00:28:08,473 - INFO -       language: english
2025-11-15 00:28:08,473 - INFO -       top_n_words: 9
2025-11-15 00:28:08,474 - INFO -       n_gram_range: (1, 2)
2025-11-15 00:28:08,474 - INFO -       min_topic_size: 154
2025-11-15 00:28:08,474 - INFO -       nr_topics: 268
2025-11-15 00:28:08,474 - INFO -       low_memory: True
2025-11-15 00:28:08,474 - INFO -       calculate_probabilities: True
2025-11-15 00:28:08,474 - INFO -       verbose: True
2025-11-15 00:28:08,477 - INFO - 
[Training] Initializing pipeline components...
2025-11-15 00:28:08,477 - INFO -   Creating UMAP model...
2025-11-15 00:28:08,477 - INFO -     Parameters: {'n_neighbors': 87, 'n_components': 16, 'min_dist': 0.05, 'metric': 'l2', 'random_state': 42}
2025-11-15 00:28:08,477 - INFO -     Using GPU version (cuML)
2025-11-15 00:28:08,483 - INFO -     ✓ UMAP model created
2025-11-15 00:28:08,483 - INFO -   Creating HDBSCAN model...
2025-11-15 00:28:08,483 - INFO -     Parameters: {'min_cluster_size': 92, 'metric': 'euclidean', 'cluster_selection_method': 'eom', 'prediction_data': True, 'gen_min_span_tree': True, 'min_samples': 54}
2025-11-15 00:28:08,483 - INFO -     Using GPU version (cuML)
2025-11-15 00:28:08,484 - INFO -     ✓ HDBSCAN model created
2025-11-15 00:28:08,484 - INFO -   Creating CountVectorizer...
2025-11-15 00:28:08,484 - INFO -     Parameters: {'stop_words': 'english', 'min_df': 0.006640909998578003, 'ngram_range': (1, 1)}
2025-11-15 00:28:08,484 - INFO -     ✓ CountVectorizer created
2025-11-15 00:28:08,484 - INFO -   Creating ClassTfidfTransformer...
2025-11-15 00:28:08,484 - INFO -     Parameters: {'reduce_frequent_words': True, 'bm25_weighting': True}
2025-11-15 00:28:08,485 - INFO -     ✓ ClassTfidfTransformer created
2025-11-15 00:28:08,485 - INFO -   Creating BERTopic model...
2025-11-15 00:28:08,485 - INFO -     BERTopic parameters: {'language': 'english', 'top_n_words': 9, 'n_gram_range': (1, 2), 'min_topic_size': 154, 'nr_topics': 268, 'low_memory': True, 'calculate_probabilities': True, 'verbose': True}
2025-11-15 00:28:08,486 - INFO -     ✓ BERTopic model created
2025-11-15 00:28:08,486 - INFO - 
[Training] Fitting BERTopic model...
2025-11-15 00:28:08,486 - INFO -   Dataset size: 9,999 sentences
2025-11-15 00:28:08,486 - INFO -   Embeddings shape: (9999, 768)
2025-11-15 00:28:08,486 - INFO -   Starting fit_transform...
2025-11-15 00:28:08,506 - BERTopic - Dimensionality - Fitting the dimensionality reduction algorithm
2025-11-15 00:28:10,428 - BERTopic - Dimensionality - Completed ✓
2025-11-15 00:28:10,438 - BERTopic - Cluster - Start clustering the reduced embeddings
2025-11-15 00:28:21,759 - BERTopic - Cluster - Completed ✓
2025-11-15 00:28:21,767 - BERTopic - Representation - Extracting topics using c-TF-IDF for topic reduction.
2025-11-15 00:28:29,046 - BERTopic - Representation - Completed ✓
2025-11-15 00:28:29,055 - BERTopic - Topic reduction - Reducing number of topics
2025-11-15 00:28:29,065 - BERTopic - Topic reduction - Number of topics (268) is equal or higher than the clustered topics(10).
2025-11-15 00:28:29,070 - BERTopic - Representation - Fine-tuning topics using representation models.
2025-11-15 00:30:21,204 - BERTopic - Representation - Completed ✓
2025-11-15 00:30:21,673 - INFO -   ✓ Model fitted in 133.2 seconds (2.22 minutes)
2025-11-15 00:30:21,673 - INFO - 
[Training] Analyzing topic assignments...
2025-11-15 00:30:21,681 - INFO -   Total topic assignments: 9,999
2025-11-15 00:30:21,681 - INFO -   Unique topics (including outliers): 10
2025-11-15 00:30:21,682 - INFO -   Number of topics (excluding outliers): 9
2025-11-15 00:30:21,682 - INFO -   Number of outliers (topic -1): 6,718 (67.2%)
2025-11-15 00:30:21,685 - INFO -   Checking topic count threshold (minimum: 200)...
2025-11-15 00:30:21,689 - WARNING -   ⚠ Model rejected: Only 9 topics found (minimum required: 200)
2025-11-15 00:30:21,689 - INFO -   Rejection reason: Topic count 9 < 200
2025-11-15 00:30:29,877 - INFO - 
================================================================================
2025-11-15 00:30:29,879 - INFO - Training #3
2025-11-15 00:30:29,883 - INFO - Embedding model: sentence-transformers/paraphrase-mpnet-base-v2
2025-11-15 00:30:29,884 - INFO - ================================================================================
2025-11-15 00:30:29,886 - INFO - Results directory: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2
2025-11-15 00:30:29,886 - INFO - Results file: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/result.json
2025-11-15 00:30:29,887 - INFO - Results CSV: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/results.csv
2025-11-15 00:30:29,894 - INFO - 
[Training] Setting hyperparameters...
2025-11-15 00:30:29,899 - INFO -   Received 12 hyperparameters from optimizer
2025-11-15 00:30:29,900 - INFO -   Hyperparameters after merging:
2025-11-15 00:30:29,903 - INFO -     umap:
2025-11-15 00:30:29,905 - INFO -       n_neighbors: 19
2025-11-15 00:30:29,905 - INFO -       n_components: 3
2025-11-15 00:30:29,906 - INFO -       min_dist: 0.05
2025-11-15 00:30:29,907 - INFO -       metric: l2
2025-11-15 00:30:29,908 - INFO -       random_state: 42
2025-11-15 00:30:29,909 - INFO -     hdbscan:
2025-11-15 00:30:29,910 - INFO -       min_cluster_size: 219
2025-11-15 00:30:29,911 - INFO -       metric: l2
2025-11-15 00:30:29,911 - INFO -       cluster_selection_method: eom
2025-11-15 00:30:29,912 - INFO -       prediction_data: True
2025-11-15 00:30:29,913 - INFO -       gen_min_span_tree: True
2025-11-15 00:30:29,914 - INFO -       min_samples: 11
2025-11-15 00:30:29,914 - INFO -     vectorizer:
2025-11-15 00:30:29,915 - INFO -       stop_words: english
2025-11-15 00:30:29,916 - INFO -       min_df: 0.004500125762023674
2025-11-15 00:30:29,917 - INFO -       ngram_range: (1, 1)
2025-11-15 00:30:29,918 - INFO -     tfdf_vectorizer:
2025-11-15 00:30:29,919 - INFO -       reduce_frequent_words: True
2025-11-15 00:30:29,919 - INFO -       bm25_weighting: True
2025-11-15 00:30:29,920 - INFO -     bertopic:
2025-11-15 00:30:29,921 - INFO -       language: english
2025-11-15 00:30:29,921 - INFO -       top_n_words: 9
2025-11-15 00:30:29,922 - INFO -       n_gram_range: (1, 1)
2025-11-15 00:30:29,923 - INFO -       min_topic_size: 164
2025-11-15 00:30:29,923 - INFO -       nr_topics: 653
2025-11-15 00:30:29,924 - INFO -       low_memory: False
2025-11-15 00:30:29,925 - INFO -       calculate_probabilities: True
2025-11-15 00:30:29,926 - INFO -       verbose: True
2025-11-15 00:30:29,931 - INFO - 
[Training] Initializing pipeline components...
2025-11-15 00:30:29,932 - INFO -   Creating UMAP model...
2025-11-15 00:30:29,933 - INFO -     Parameters: {'n_neighbors': 19, 'n_components': 3, 'min_dist': 0.05, 'metric': 'l2', 'random_state': 42}
2025-11-15 00:30:29,934 - INFO -     Using GPU version (cuML)
2025-11-15 00:30:29,951 - INFO -     ✓ UMAP model created
2025-11-15 00:30:29,952 - INFO -   Creating HDBSCAN model...
2025-11-15 00:30:29,953 - INFO -     Parameters: {'min_cluster_size': 219, 'metric': 'l2', 'cluster_selection_method': 'eom', 'prediction_data': True, 'gen_min_span_tree': True, 'min_samples': 11}
2025-11-15 00:30:29,953 - INFO -     Using GPU version (cuML)
2025-11-15 00:30:29,954 - INFO -     ✓ HDBSCAN model created
2025-11-15 00:30:29,955 - INFO -   Creating CountVectorizer...
2025-11-15 00:30:29,955 - INFO -     Parameters: {'stop_words': 'english', 'min_df': 0.004500125762023674, 'ngram_range': (1, 1)}
2025-11-15 00:30:29,963 - INFO -     ✓ CountVectorizer created
2025-11-15 00:30:29,965 - INFO -   Creating ClassTfidfTransformer...
2025-11-15 00:30:29,966 - INFO -     Parameters: {'reduce_frequent_words': True, 'bm25_weighting': True}
2025-11-15 00:30:29,966 - INFO -     ✓ ClassTfidfTransformer created
2025-11-15 00:30:29,970 - INFO -   Creating BERTopic model...
2025-11-15 00:30:29,970 - INFO -     BERTopic parameters: {'language': 'english', 'top_n_words': 9, 'n_gram_range': (1, 1), 'min_topic_size': 164, 'nr_topics': 653, 'low_memory': False, 'calculate_probabilities': True, 'verbose': True}
2025-11-15 00:30:29,979 - INFO -     ✓ BERTopic model created
2025-11-15 00:30:29,981 - INFO - 
[Training] Fitting BERTopic model...
2025-11-15 00:30:29,984 - INFO -   Dataset size: 9,999 sentences
2025-11-15 00:30:29,985 - INFO -   Embeddings shape: (9999, 768)
2025-11-15 00:30:29,985 - INFO -   Starting fit_transform...
2025-11-15 00:30:30,051 - BERTopic - Dimensionality - Fitting the dimensionality reduction algorithm
2025-11-15 00:30:31,164 - BERTopic - Dimensionality - Completed ✓
2025-11-15 00:30:31,168 - BERTopic - Cluster - Start clustering the reduced embeddings
2025-11-15 00:30:47,835 - BERTopic - Cluster - Completed ✓
2025-11-15 00:30:47,863 - BERTopic - Representation - Extracting topics using c-TF-IDF for topic reduction.
2025-11-15 00:30:56,014 - BERTopic - Representation - Completed ✓
2025-11-15 00:30:56,023 - BERTopic - Topic reduction - Reducing number of topics
2025-11-15 00:30:56,028 - BERTopic - Topic reduction - Number of topics (653) is equal or higher than the clustered topics(7).
2025-11-15 00:30:56,030 - BERTopic - Representation - Fine-tuning topics using representation models.
2025-11-15 00:32:40,676 - BERTopic - Representation - Completed ✓
2025-11-15 00:32:41,618 - INFO -   ✓ Model fitted in 131.6 seconds (2.19 minutes)
2025-11-15 00:32:41,623 - INFO - 
[Training] Analyzing topic assignments...
2025-11-15 00:32:41,630 - INFO -   Total topic assignments: 9,999
2025-11-15 00:32:41,632 - INFO -   Unique topics (including outliers): 7
2025-11-15 00:32:41,633 - INFO -   Number of topics (excluding outliers): 6
2025-11-15 00:32:41,642 - INFO -   Number of outliers (topic -1): 5,404 (54.0%)
2025-11-15 00:32:41,644 - INFO -   Checking topic count threshold (minimum: 200)...
2025-11-15 00:32:41,646 - WARNING -   ⚠ Model rejected: Only 6 topics found (minimum required: 200)
2025-11-15 00:32:41,647 - INFO -   Rejection reason: Topic count 6 < 200
2025-11-15 00:33:08,531 - INFO - 
================================================================================
2025-11-15 00:33:08,534 - INFO - Training #4
2025-11-15 00:33:08,536 - INFO - Embedding model: sentence-transformers/paraphrase-mpnet-base-v2
2025-11-15 00:33:08,538 - INFO - ================================================================================
2025-11-15 00:33:08,543 - INFO - Results directory: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2
2025-11-15 00:33:08,546 - INFO - Results file: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/result.json
2025-11-15 00:33:08,549 - INFO - Results CSV: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/results.csv
2025-11-15 00:33:08,554 - INFO - 
[Training] Setting hyperparameters...
2025-11-15 00:33:08,556 - INFO -   Received 12 hyperparameters from optimizer
2025-11-15 00:33:08,560 - INFO -   Hyperparameters after merging:
2025-11-15 00:33:08,562 - INFO -     umap:
2025-11-15 00:33:08,564 - INFO -       n_neighbors: 53
2025-11-15 00:33:08,566 - INFO -       n_components: 3
2025-11-15 00:33:08,568 - INFO -       min_dist: 0.05
2025-11-15 00:33:08,570 - INFO -       metric: euclidean
2025-11-15 00:33:08,572 - INFO -       random_state: 42
2025-11-15 00:33:08,574 - INFO -     hdbscan:
2025-11-15 00:33:08,576 - INFO -       min_cluster_size: 128
2025-11-15 00:33:08,578 - INFO -       metric: l2
2025-11-15 00:33:08,579 - INFO -       cluster_selection_method: eom
2025-11-15 00:33:08,580 - INFO -       prediction_data: True
2025-11-15 00:33:08,582 - INFO -       gen_min_span_tree: True
2025-11-15 00:33:08,583 - INFO -       min_samples: 253
2025-11-15 00:33:08,584 - INFO -     vectorizer:
2025-11-15 00:33:08,585 - INFO -       stop_words: english
2025-11-15 00:33:08,588 - INFO -       min_df: 0.004557257372508552
2025-11-15 00:33:08,590 - INFO -       ngram_range: (1, 1)
2025-11-15 00:33:08,591 - INFO -     tfdf_vectorizer:
2025-11-15 00:33:08,593 - INFO -       reduce_frequent_words: True
2025-11-15 00:33:08,595 - INFO -       bm25_weighting: True
2025-11-15 00:33:08,597 - INFO -     bertopic:
2025-11-15 00:33:08,599 - INFO -       language: english
2025-11-15 00:33:08,601 - INFO -       top_n_words: 23
2025-11-15 00:33:08,603 - INFO -       n_gram_range: (1, 1)
2025-11-15 00:33:08,605 - INFO -       min_topic_size: 261
2025-11-15 00:33:08,606 - INFO -       nr_topics: 304
2025-11-15 00:33:08,609 - INFO -       low_memory: True
2025-11-15 00:33:08,610 - INFO -       calculate_probabilities: True
2025-11-15 00:33:08,611 - INFO -       verbose: True
2025-11-15 00:33:08,614 - WARNING -   ⚠ Constraint violation: min_samples (253) > min_cluster_size (128)
2025-11-15 00:33:08,616 - INFO -   Enforcing constraint: setting min_samples = min_cluster_size = 128
2025-11-15 00:33:08,617 - INFO -   ✓ Constraint enforced
2025-11-15 00:33:08,633 - INFO - 
[Training] Initializing pipeline components...
2025-11-15 00:33:08,636 - INFO -   Creating UMAP model...
2025-11-15 00:33:08,638 - INFO -     Parameters: {'n_neighbors': 53, 'n_components': 3, 'min_dist': 0.05, 'metric': 'euclidean', 'random_state': 42}
2025-11-15 00:33:08,641 - INFO -     Using GPU version (cuML)
2025-11-15 00:33:08,688 - INFO -     ✓ UMAP model created
2025-11-15 00:33:08,691 - INFO -   Creating HDBSCAN model...
2025-11-15 00:33:08,694 - INFO -     Parameters: {'min_cluster_size': 128, 'metric': 'l2', 'cluster_selection_method': 'eom', 'prediction_data': True, 'gen_min_span_tree': True, 'min_samples': 128}
2025-11-15 00:33:08,696 - INFO -     Using GPU version (cuML)
2025-11-15 00:33:08,701 - INFO -     ✓ HDBSCAN model created
2025-11-15 00:33:08,704 - INFO -   Creating CountVectorizer...
2025-11-15 00:33:08,706 - INFO -     Parameters: {'stop_words': 'english', 'min_df': 0.004557257372508552, 'ngram_range': (1, 1)}
2025-11-15 00:33:08,708 - INFO -     ✓ CountVectorizer created
2025-11-15 00:33:08,710 - INFO -   Creating ClassTfidfTransformer...
2025-11-15 00:33:08,712 - INFO -     Parameters: {'reduce_frequent_words': True, 'bm25_weighting': True}
2025-11-15 00:33:08,713 - INFO -     ✓ ClassTfidfTransformer created
2025-11-15 00:33:08,715 - INFO -   Creating BERTopic model...
2025-11-15 00:33:08,717 - INFO -     BERTopic parameters: {'language': 'english', 'top_n_words': 23, 'n_gram_range': (1, 1), 'min_topic_size': 261, 'nr_topics': 304, 'low_memory': True, 'calculate_probabilities': True, 'verbose': True}
2025-11-15 00:33:08,723 - INFO -     ✓ BERTopic model created
2025-11-15 00:33:08,725 - INFO - 
[Training] Fitting BERTopic model...
2025-11-15 00:33:08,727 - INFO -   Dataset size: 9,999 sentences
2025-11-15 00:33:08,729 - INFO -   Embeddings shape: (9999, 768)
2025-11-15 00:33:08,730 - INFO -   Starting fit_transform...
2025-11-15 00:33:08,841 - BERTopic - Dimensionality - Fitting the dimensionality reduction algorithm
2025-11-15 00:33:10,206 - BERTopic - Dimensionality - Completed ✓
2025-11-15 00:33:10,213 - BERTopic - Cluster - Start clustering the reduced embeddings
2025-11-15 00:33:24,031 - BERTopic - Cluster - Completed ✓
2025-11-15 00:33:24,040 - BERTopic - Representation - Extracting topics using c-TF-IDF for topic reduction.
2025-11-15 00:33:33,656 - BERTopic - Representation - Completed ✓
2025-11-15 00:33:33,666 - BERTopic - Topic reduction - Reducing number of topics
2025-11-15 00:33:33,668 - BERTopic - Topic reduction - Number of topics (304) is equal or higher than the clustered topics(7).
2025-11-15 00:33:33,674 - BERTopic - Representation - Fine-tuning topics using representation models.
2025-11-15 00:35:28,335 - BERTopic - Representation - Completed ✓
2025-11-15 00:35:28,874 - INFO -   ✓ Model fitted in 140.1 seconds (2.34 minutes)
2025-11-15 00:35:28,875 - INFO - 
[Training] Analyzing topic assignments...
2025-11-15 00:35:28,878 - INFO -   Total topic assignments: 9,999
2025-11-15 00:35:28,878 - INFO -   Unique topics (including outliers): 7
2025-11-15 00:35:28,879 - INFO -   Number of topics (excluding outliers): 6
2025-11-15 00:35:28,880 - INFO -   Number of outliers (topic -1): 7,465 (74.7%)
2025-11-15 00:35:28,880 - INFO -   Checking topic count threshold (minimum: 200)...
2025-11-15 00:35:28,880 - WARNING -   ⚠ Model rejected: Only 6 topics found (minimum required: 200)
2025-11-15 00:35:28,881 - INFO -   Rejection reason: Topic count 6 < 200
2025-11-15 00:35:56,684 - INFO - 
================================================================================
2025-11-15 00:35:56,691 - INFO - Training #5
2025-11-15 00:35:56,696 - INFO - Embedding model: sentence-transformers/paraphrase-mpnet-base-v2
2025-11-15 00:35:56,697 - INFO - ================================================================================
2025-11-15 00:35:56,710 - INFO - Results directory: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2
2025-11-15 00:35:56,719 - INFO - Results file: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/result.json
2025-11-15 00:35:56,723 - INFO - Results CSV: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/results.csv
2025-11-15 00:35:56,728 - INFO - 
[Training] Setting hyperparameters...
2025-11-15 00:35:56,730 - INFO -   Received 12 hyperparameters from optimizer
2025-11-15 00:35:56,734 - INFO -   Hyperparameters after merging:
2025-11-15 00:35:56,736 - INFO -     umap:
2025-11-15 00:35:56,737 - INFO -       n_neighbors: 18
2025-11-15 00:35:56,738 - INFO -       n_components: 6
2025-11-15 00:35:56,741 - INFO -       min_dist: 0.05
2025-11-15 00:35:56,743 - INFO -       metric: l2
2025-11-15 00:35:56,744 - INFO -       random_state: 42
2025-11-15 00:35:56,746 - INFO -     hdbscan:
2025-11-15 00:35:56,748 - INFO -       min_cluster_size: 26
2025-11-15 00:35:56,749 - INFO -       metric: l2
2025-11-15 00:35:56,751 - INFO -       cluster_selection_method: eom
2025-11-15 00:35:56,753 - INFO -       prediction_data: True
2025-11-15 00:35:56,754 - INFO -       gen_min_span_tree: True
2025-11-15 00:35:56,757 - INFO -       min_samples: 138
2025-11-15 00:35:56,759 - INFO -     vectorizer:
2025-11-15 00:35:56,761 - INFO -       stop_words: english
2025-11-15 00:35:56,763 - INFO -       min_df: 0.0071391637536021195
2025-11-15 00:35:56,764 - INFO -       ngram_range: (1, 1)
2025-11-15 00:35:56,766 - INFO -     tfdf_vectorizer:
2025-11-15 00:35:56,768 - INFO -       reduce_frequent_words: True
2025-11-15 00:35:56,769 - INFO -       bm25_weighting: True
2025-11-15 00:35:56,771 - INFO -     bertopic:
2025-11-15 00:35:56,773 - INFO -       language: english
2025-11-15 00:35:56,774 - INFO -       top_n_words: 14
2025-11-15 00:35:56,776 - INFO -       n_gram_range: (1, 1)
2025-11-15 00:35:56,777 - INFO -       min_topic_size: 309
2025-11-15 00:35:56,779 - INFO -       nr_topics: 265
2025-11-15 00:35:56,781 - INFO -       low_memory: True
2025-11-15 00:35:56,782 - INFO -       calculate_probabilities: True
2025-11-15 00:35:56,784 - INFO -       verbose: True
2025-11-15 00:35:56,785 - WARNING -   ⚠ Constraint violation: min_samples (138) > min_cluster_size (26)
2025-11-15 00:35:56,787 - INFO -   Enforcing constraint: setting min_samples = min_cluster_size = 26
2025-11-15 00:35:56,789 - INFO -   ✓ Constraint enforced
2025-11-15 00:35:56,833 - INFO - 
[Training] Initializing pipeline components...
2025-11-15 00:35:56,840 - INFO -   Creating UMAP model...
2025-11-15 00:35:56,845 - INFO -     Parameters: {'n_neighbors': 18, 'n_components': 6, 'min_dist': 0.05, 'metric': 'l2', 'random_state': 42}
2025-11-15 00:35:56,847 - INFO -     Using GPU version (cuML)
2025-11-15 00:35:57,194 - INFO -     ✓ UMAP model created
2025-11-15 00:35:57,202 - INFO -   Creating HDBSCAN model...
2025-11-15 00:35:57,205 - INFO -     Parameters: {'min_cluster_size': 26, 'metric': 'l2', 'cluster_selection_method': 'eom', 'prediction_data': True, 'gen_min_span_tree': True, 'min_samples': 26}
2025-11-15 00:35:57,206 - INFO -     Using GPU version (cuML)
2025-11-15 00:35:57,209 - INFO -     ✓ HDBSCAN model created
2025-11-15 00:35:57,211 - INFO -   Creating CountVectorizer...
2025-11-15 00:35:57,215 - INFO -     Parameters: {'stop_words': 'english', 'min_df': 0.0071391637536021195, 'ngram_range': (1, 1)}
2025-11-15 00:35:57,219 - INFO -     ✓ CountVectorizer created
2025-11-15 00:35:57,221 - INFO -   Creating ClassTfidfTransformer...
2025-11-15 00:35:57,223 - INFO -     Parameters: {'reduce_frequent_words': True, 'bm25_weighting': True}
2025-11-15 00:35:57,225 - INFO -     ✓ ClassTfidfTransformer created
2025-11-15 00:35:57,227 - INFO -   Creating BERTopic model...
2025-11-15 00:35:57,229 - INFO -     BERTopic parameters: {'language': 'english', 'top_n_words': 14, 'n_gram_range': (1, 1), 'min_topic_size': 309, 'nr_topics': 265, 'low_memory': True, 'calculate_probabilities': True, 'verbose': True}
2025-11-15 00:35:57,235 - INFO -     ✓ BERTopic model created
2025-11-15 00:35:57,237 - INFO - 
[Training] Fitting BERTopic model...
2025-11-15 00:35:57,242 - INFO -   Dataset size: 9,999 sentences
2025-11-15 00:35:57,245 - INFO -   Embeddings shape: (9999, 768)
2025-11-15 00:35:57,250 - INFO -   Starting fit_transform...
2025-11-15 00:35:57,622 - BERTopic - Dimensionality - Fitting the dimensionality reduction algorithm
2025-11-15 00:35:59,973 - BERTopic - Dimensionality - Completed ✓
2025-11-15 00:35:59,981 - BERTopic - Cluster - Start clustering the reduced embeddings
2025-11-15 00:36:13,645 - BERTopic - Cluster - Completed ✓
2025-11-15 00:36:13,673 - BERTopic - Representation - Extracting topics using c-TF-IDF for topic reduction.
2025-11-15 00:36:23,336 - BERTopic - Representation - Completed ✓
2025-11-15 00:36:23,346 - BERTopic - Topic reduction - Reducing number of topics
2025-11-15 00:36:23,354 - BERTopic - Topic reduction - Number of topics (265) is equal or higher than the clustered topics(27).
2025-11-15 00:36:23,355 - BERTopic - Representation - Fine-tuning topics using representation models.
2025-11-15 00:40:40,361 - BERTopic - Representation - Completed ✓
2025-11-15 00:40:41,275 - INFO -   ✓ Model fitted in 284.0 seconds (4.73 minutes)
2025-11-15 00:40:41,277 - INFO - 
[Training] Analyzing topic assignments...
2025-11-15 00:40:41,284 - INFO -   Total topic assignments: 9,999
2025-11-15 00:40:41,286 - INFO -   Unique topics (including outliers): 27
2025-11-15 00:40:41,287 - INFO -   Number of topics (excluding outliers): 26
2025-11-15 00:40:41,289 - INFO -   Number of outliers (topic -1): 5,793 (57.9%)
2025-11-15 00:40:41,289 - INFO -   Checking topic count threshold (minimum: 200)...
2025-11-15 00:40:41,290 - WARNING -   ⚠ Model rejected: Only 26 topics found (minimum required: 200)
2025-11-15 00:40:41,292 - INFO -   Rejection reason: Topic count 26 < 200
2025-11-15 00:40:47,533 - INFO - 
================================================================================
2025-11-15 00:40:47,537 - INFO - Training #6
2025-11-15 00:40:47,540 - INFO - Embedding model: sentence-transformers/paraphrase-mpnet-base-v2
2025-11-15 00:40:47,541 - INFO - ================================================================================
2025-11-15 00:40:47,546 - INFO - Results directory: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2
2025-11-15 00:40:47,548 - INFO - Results file: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/result.json
2025-11-15 00:40:47,549 - INFO - Results CSV: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/results.csv
2025-11-15 00:40:47,563 - INFO - 
[Training] Setting hyperparameters...
2025-11-15 00:40:47,566 - INFO -   Received 12 hyperparameters from optimizer
2025-11-15 00:40:47,568 - INFO -   Hyperparameters after merging:
2025-11-15 00:40:47,569 - INFO -     umap:
2025-11-15 00:40:47,572 - INFO -       n_neighbors: 78
2025-11-15 00:40:47,573 - INFO -       n_components: 3
2025-11-15 00:40:47,574 - INFO -       min_dist: 0.05
2025-11-15 00:40:47,575 - INFO -       metric: euclidean
2025-11-15 00:40:47,575 - INFO -       random_state: 42
2025-11-15 00:40:47,582 - INFO -     hdbscan:
2025-11-15 00:40:47,584 - INFO -       min_cluster_size: 117
2025-11-15 00:40:47,585 - INFO -       metric: euclidean
2025-11-15 00:40:47,589 - INFO -       cluster_selection_method: eom
2025-11-15 00:40:47,589 - INFO -       prediction_data: True
2025-11-15 00:40:47,590 - INFO -       gen_min_span_tree: True
2025-11-15 00:40:47,591 - INFO -       min_samples: 30
2025-11-15 00:40:47,594 - INFO -     vectorizer:
2025-11-15 00:40:47,596 - INFO -       stop_words: english
2025-11-15 00:40:47,599 - INFO -       min_df: 0.005328973671668823
2025-11-15 00:40:47,600 - INFO -       ngram_range: (1, 1)
2025-11-15 00:40:47,604 - INFO -     tfdf_vectorizer:
2025-11-15 00:40:47,605 - INFO -       reduce_frequent_words: True
2025-11-15 00:40:47,606 - INFO -       bm25_weighting: True
2025-11-15 00:40:47,607 - INFO -     bertopic:
2025-11-15 00:40:47,610 - INFO -       language: english
2025-11-15 00:40:47,613 - INFO -       top_n_words: 18
2025-11-15 00:40:47,616 - INFO -       n_gram_range: (1, 3)
2025-11-15 00:40:47,617 - INFO -       min_topic_size: 474
2025-11-15 00:40:47,622 - INFO -       nr_topics: 254
2025-11-15 00:40:47,623 - INFO -       low_memory: False
2025-11-15 00:40:47,626 - INFO -       calculate_probabilities: True
2025-11-15 00:40:47,628 - INFO -       verbose: True
2025-11-15 00:40:47,637 - INFO - 
[Training] Initializing pipeline components...
2025-11-15 00:40:47,638 - INFO -   Creating UMAP model...
2025-11-15 00:40:47,640 - INFO -     Parameters: {'n_neighbors': 78, 'n_components': 3, 'min_dist': 0.05, 'metric': 'euclidean', 'random_state': 42}
2025-11-15 00:40:47,641 - INFO -     Using GPU version (cuML)
2025-11-15 00:40:47,670 - INFO -     ✓ UMAP model created
2025-11-15 00:40:47,672 - INFO -   Creating HDBSCAN model...
2025-11-15 00:40:47,674 - INFO -     Parameters: {'min_cluster_size': 117, 'metric': 'euclidean', 'cluster_selection_method': 'eom', 'prediction_data': True, 'gen_min_span_tree': True, 'min_samples': 30}
2025-11-15 00:40:47,675 - INFO -     Using GPU version (cuML)
2025-11-15 00:40:47,677 - INFO -     ✓ HDBSCAN model created
2025-11-15 00:40:47,678 - INFO -   Creating CountVectorizer...
2025-11-15 00:40:47,679 - INFO -     Parameters: {'stop_words': 'english', 'min_df': 0.005328973671668823, 'ngram_range': (1, 1)}
2025-11-15 00:40:47,680 - INFO -     ✓ CountVectorizer created
2025-11-15 00:40:47,681 - INFO -   Creating ClassTfidfTransformer...
2025-11-15 00:40:47,683 - INFO -     Parameters: {'reduce_frequent_words': True, 'bm25_weighting': True}
2025-11-15 00:40:47,684 - INFO -     ✓ ClassTfidfTransformer created
2025-11-15 00:40:47,685 - INFO -   Creating BERTopic model...
2025-11-15 00:40:47,686 - INFO -     BERTopic parameters: {'language': 'english', 'top_n_words': 18, 'n_gram_range': (1, 3), 'min_topic_size': 474, 'nr_topics': 254, 'low_memory': False, 'calculate_probabilities': True, 'verbose': True}
2025-11-15 00:40:47,689 - INFO -     ✓ BERTopic model created
2025-11-15 00:40:47,690 - INFO - 
[Training] Fitting BERTopic model...
2025-11-15 00:40:47,691 - INFO -   Dataset size: 9,999 sentences
2025-11-15 00:40:47,692 - INFO -   Embeddings shape: (9999, 768)
2025-11-15 00:40:47,693 - INFO -   Starting fit_transform...
2025-11-15 00:40:47,760 - BERTopic - Dimensionality - Fitting the dimensionality reduction algorithm
2025-11-15 00:40:49,675 - BERTopic - Dimensionality - Completed ✓
2025-11-15 00:40:49,682 - BERTopic - Cluster - Start clustering the reduced embeddings
2025-11-15 00:41:00,672 - BERTopic - Cluster - Completed ✓
2025-11-15 00:41:00,686 - BERTopic - Representation - Extracting topics using c-TF-IDF for topic reduction.
2025-11-15 00:41:08,867 - BERTopic - Representation - Completed ✓
2025-11-15 00:41:08,894 - BERTopic - Topic reduction - Reducing number of topics
2025-11-15 00:41:08,896 - BERTopic - Topic reduction - Number of topics (254) is equal or higher than the clustered topics(11).
2025-11-15 00:41:08,897 - BERTopic - Representation - Fine-tuning topics using representation models.
2025-11-15 00:43:17,470 - BERTopic - Representation - Completed ✓
2025-11-15 00:43:19,807 - INFO -   ✓ Model fitted in 152.1 seconds (2.54 minutes)
2025-11-15 00:43:19,811 - INFO - 
[Training] Analyzing topic assignments...
2025-11-15 00:43:19,825 - INFO -   Total topic assignments: 9,999
2025-11-15 00:43:19,828 - INFO -   Unique topics (including outliers): 11
2025-11-15 00:43:19,830 - INFO -   Number of topics (excluding outliers): 10
2025-11-15 00:43:19,834 - INFO -   Number of outliers (topic -1): 5,898 (59.0%)
2025-11-15 00:43:19,837 - INFO -   Checking topic count threshold (minimum: 200)...
2025-11-15 00:43:19,839 - WARNING -   ⚠ Model rejected: Only 10 topics found (minimum required: 200)
2025-11-15 00:43:19,841 - INFO -   Rejection reason: Topic count 10 < 200
2025-11-15 00:43:41,283 - INFO - 
================================================================================
2025-11-15 00:43:41,286 - INFO - Training #7
2025-11-15 00:43:41,290 - INFO - Embedding model: sentence-transformers/paraphrase-mpnet-base-v2
2025-11-15 00:43:41,299 - INFO - ================================================================================
2025-11-15 00:43:41,310 - INFO - Results directory: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2
2025-11-15 00:43:41,325 - INFO - Results file: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/result.json
2025-11-15 00:43:41,338 - INFO - Results CSV: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/results.csv
2025-11-15 00:43:41,358 - INFO - 
[Training] Setting hyperparameters...
2025-11-15 00:43:41,364 - INFO -   Received 12 hyperparameters from optimizer
2025-11-15 00:43:41,372 - INFO -   Hyperparameters after merging:
2025-11-15 00:43:41,373 - INFO -     umap:
2025-11-15 00:43:41,375 - INFO -       n_neighbors: 55
2025-11-15 00:43:41,377 - INFO -       n_components: 16
2025-11-15 00:43:41,379 - INFO -       min_dist: 0.05
2025-11-15 00:43:41,380 - INFO -       metric: l2
2025-11-15 00:43:41,382 - INFO -       random_state: 42
2025-11-15 00:43:41,384 - INFO -     hdbscan:
2025-11-15 00:43:41,385 - INFO -       min_cluster_size: 226
2025-11-15 00:43:41,387 - INFO -       metric: euclidean
2025-11-15 00:43:41,389 - INFO -       cluster_selection_method: eom
2025-11-15 00:43:41,391 - INFO -       prediction_data: True
2025-11-15 00:43:41,393 - INFO -       gen_min_span_tree: True
2025-11-15 00:43:41,394 - INFO -       min_samples: 285
2025-11-15 00:43:41,395 - INFO -     vectorizer:
2025-11-15 00:43:41,398 - INFO -       stop_words: english
2025-11-15 00:43:41,399 - INFO -       min_df: 0.0069094324741411205
2025-11-15 00:43:41,400 - INFO -       ngram_range: (1, 1)
2025-11-15 00:43:41,401 - INFO -     tfdf_vectorizer:
2025-11-15 00:43:41,404 - INFO -       reduce_frequent_words: True
2025-11-15 00:43:41,406 - INFO -       bm25_weighting: True
2025-11-15 00:43:41,407 - INFO -     bertopic:
2025-11-15 00:43:41,408 - INFO -       language: english
2025-11-15 00:43:41,409 - INFO -       top_n_words: 9
2025-11-15 00:43:41,410 - INFO -       n_gram_range: (1, 3)
2025-11-15 00:43:41,413 - INFO -       min_topic_size: 358
2025-11-15 00:43:41,414 - INFO -       nr_topics: 462
2025-11-15 00:43:41,416 - INFO -       low_memory: False
2025-11-15 00:43:41,418 - INFO -       calculate_probabilities: True
2025-11-15 00:43:41,419 - INFO -       verbose: True
2025-11-15 00:43:41,421 - WARNING -   ⚠ Constraint violation: min_samples (285) > min_cluster_size (226)
2025-11-15 00:43:41,423 - INFO -   Enforcing constraint: setting min_samples = min_cluster_size = 226
2025-11-15 00:43:41,424 - INFO -   ✓ Constraint enforced
2025-11-15 00:43:41,437 - INFO - 
[Training] Initializing pipeline components...
2025-11-15 00:43:41,438 - INFO -   Creating UMAP model...
2025-11-15 00:43:41,441 - INFO -     Parameters: {'n_neighbors': 55, 'n_components': 16, 'min_dist': 0.05, 'metric': 'l2', 'random_state': 42}
2025-11-15 00:43:41,442 - INFO -     Using GPU version (cuML)
2025-11-15 00:43:41,477 - INFO -     ✓ UMAP model created
2025-11-15 00:43:41,479 - INFO -   Creating HDBSCAN model...
2025-11-15 00:43:41,481 - INFO -     Parameters: {'min_cluster_size': 226, 'metric': 'euclidean', 'cluster_selection_method': 'eom', 'prediction_data': True, 'gen_min_span_tree': True, 'min_samples': 226}
2025-11-15 00:43:41,482 - INFO -     Using GPU version (cuML)
2025-11-15 00:43:41,485 - INFO -     ✓ HDBSCAN model created
2025-11-15 00:43:41,487 - INFO -   Creating CountVectorizer...
2025-11-15 00:43:41,489 - INFO -     Parameters: {'stop_words': 'english', 'min_df': 0.0069094324741411205, 'ngram_range': (1, 1)}
2025-11-15 00:43:41,491 - INFO -     ✓ CountVectorizer created
2025-11-15 00:43:41,493 - INFO -   Creating ClassTfidfTransformer...
2025-11-15 00:43:41,494 - INFO -     Parameters: {'reduce_frequent_words': True, 'bm25_weighting': True}
2025-11-15 00:43:41,496 - INFO -     ✓ ClassTfidfTransformer created
2025-11-15 00:43:41,498 - INFO -   Creating BERTopic model...
2025-11-15 00:43:41,500 - INFO -     BERTopic parameters: {'language': 'english', 'top_n_words': 9, 'n_gram_range': (1, 3), 'min_topic_size': 358, 'nr_topics': 462, 'low_memory': False, 'calculate_probabilities': True, 'verbose': True}
2025-11-15 00:43:41,505 - INFO -     ✓ BERTopic model created
2025-11-15 00:43:41,507 - INFO - 
[Training] Fitting BERTopic model...
2025-11-15 00:43:41,509 - INFO -   Dataset size: 9,999 sentences
2025-11-15 00:43:41,511 - INFO -   Embeddings shape: (9999, 768)
2025-11-15 00:43:41,513 - INFO -   Starting fit_transform...
2025-11-15 00:43:41,668 - BERTopic - Dimensionality - Fitting the dimensionality reduction algorithm
2025-11-15 00:43:45,951 - BERTopic - Dimensionality - Completed ✓
2025-11-15 00:43:46,179 - BERTopic - Cluster - Start clustering the reduced embeddings
2025-11-15 00:44:01,399 - BERTopic - Cluster - Completed ✓
2025-11-15 00:44:01,408 - BERTopic - Representation - Extracting topics using c-TF-IDF for topic reduction.
2025-11-15 00:44:08,084 - BERTopic - Representation - Completed ✓
2025-11-15 00:44:08,089 - BERTopic - Topic reduction - Reducing number of topics
2025-11-15 00:44:08,091 - BERTopic - Topic reduction - Number of topics (462) is equal or higher than the clustered topics(3).
2025-11-15 00:44:08,092 - BERTopic - Representation - Fine-tuning topics using representation models.
