2025-11-14 23:17:09,790 - INFO - ✓ GPU libraries (cuML) available - will use GPU for UMAP/HDBSCAN
2025-11-14 23:17:09,827 - INFO - ================================================================================
2025-11-14 23:17:09,828 - INFO - BERTopic + OCTIS Optimization for Reviews Corpus
2025-11-14 23:17:09,828 - INFO - ================================================================================
2025-11-14 23:17:09,828 - INFO - 
Memory Optimization Settings:
2025-11-14 23:17:09,828 - INFO -   Max embedding models: 1
2025-11-14 23:17:09,829 - INFO -   Embedding batch size: 8
2025-11-14 23:17:09,829 - INFO -   Optimization multiplier: 15
2025-11-14 23:17:09,829 - INFO -   Max sentences: 10,000
2025-11-14 23:17:09,829 - INFO -   Process one model at a time: True
2025-11-14 23:17:09,829 - INFO - 
[STEP 1] Loading configuration...
2025-11-14 23:17:09,830 - INFO - Loading configuration from: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/src/reviews_analysis/BERTopic_OCTIS/config_bertopic_reviews.yaml
2025-11-14 23:17:09,844 - INFO - ✓ Configuration loaded successfully
2025-11-14 23:17:09,845 - INFO -   Configuration loaded: 12 parameter groups
2025-11-14 23:17:09,845 - INFO -   Available parameters: embedding_model, top_n_words, n_gram_range, min_topic_size, nr_topics, low_memory, umap_n_neighbors, umap_n_components, umap_metric, hdbscan_min_cluster_size, hdbscan_min_samples, hdbscan_metric
2025-11-14 23:17:09,845 - INFO - 
[STEP 2] Loading dataset...
2025-11-14 23:17:09,845 - INFO -   Checking for test dataset: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/review_sentences_test_10k.parquet
2025-11-14 23:17:09,846 - INFO - Found test dataset: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/review_sentences_test_10k.parquet
2025-11-14 23:17:09,846 - INFO -   Loading from test parquet (for quick testing)
2025-11-14 23:17:09,846 - WARNING -   NOTE: Test dataset may have cleaned text. For production, use raw text from reviews.
2025-11-14 23:17:09,847 - INFO - Loading sentences from parquet: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/review_sentences_test_10k.parquet
2025-11-14 23:17:09,981 - INFO -   Loaded 9,999 sentences
2025-11-14 23:17:09,981 - INFO -   ✓ Loaded 9,999 raw sentences
2025-11-14 23:17:09,981 - INFO -   Columns: ['sentence_id', 'sentence_text', 'review_id', 'work_id', 'pop_tier', 'rating', 'sentence_index', 'n_sentences_in_review']
2025-11-14 23:17:09,982 - INFO - 
  Pop tier distribution:
2025-11-14 23:17:09,992 - INFO -     mid: 3,333 (33.3%)
2025-11-14 23:17:09,994 - INFO -     thrash: 3,333 (33.3%)
2025-11-14 23:17:09,995 - INFO -     top: 3,333 (33.3%)
2025-11-14 23:17:09,995 - INFO - 
[STEP 3] Preparing dataset for embeddings and coherence...
2025-11-14 23:17:09,996 - INFO -   Total sentences for embeddings: 9,999
2025-11-14 23:17:10,005 - INFO -   Metadata columns stored: ['sentence_id', 'review_id', 'work_id', 'pop_tier', 'rating']
2025-11-14 23:17:10,060 - INFO -   Prepared 9,999 sentences for coherence calculation
2025-11-14 23:17:10,060 - INFO - 
[STEP 4] Preparing OCTIS dataset format...
2025-11-14 23:17:10,061 - INFO -   OCTIS dataset path: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews
2025-11-14 23:17:10,061 - INFO -   Creating OCTIS corpus.tsv file...
2025-11-14 23:17:11,364 - INFO -   Writing 9,999 rows to TSV...
2025-11-14 23:17:11,448 - INFO -   ✓ Created OCTIS corpus: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/corpus.tsv
2025-11-14 23:17:11,448 - INFO -   Total sentences: 9,999
2025-11-14 23:17:11,449 - INFO -   Label format: work_id (book-level)
2025-11-14 23:17:11,449 - INFO -   Loading OCTIS dataset...
2025-11-14 23:17:11,656 - INFO -   ✓ OCTIS dataset loaded successfully
2025-11-14 23:17:13,495 - INFO - 
[STEP 5] Loading embedding models...
2025-11-14 23:17:13,495 - INFO -   Limiting to 1 models (from 4 in config)
2025-11-14 23:17:13,496 - INFO -   Using 1 embedding models from config:
2025-11-14 23:17:13,496 - INFO -     1. sentence-transformers/paraphrase-mpnet-base-v2
2025-11-14 23:17:13,496 - INFO - 
  Determining compute device...
2025-11-14 23:17:13,503 - INFO -   ✓ Using GPU device: NVIDIA GeForce RTX 2070 with Max-Q Design
2025-11-14 23:17:13,503 - INFO -   GPU memory: 8.2 GB
2025-11-14 23:17:13,504 - INFO - 
  Loading 1 embedding model(s)...
2025-11-14 23:17:13,504 - INFO -   [1/1] Loading: sentence-transformers/paraphrase-mpnet-base-v2
2025-11-14 23:17:13,504 - INFO -     Device: cuda
2025-11-14 23:17:13,505 - INFO - Load pretrained SentenceTransformer: sentence-transformers/paraphrase-mpnet-base-v2
2025-11-14 23:17:16,510 - INFO -     ✓ Model loaded in 3.01 seconds
2025-11-14 23:17:16,510 - INFO - 
[STEP 6] Calculating/loading embeddings...
2025-11-14 23:17:16,510 - INFO -   Using raw, unpreprocessed text for embeddings
2025-11-14 23:17:16,510 - INFO -   Number of sentences: 9,999
2025-11-14 23:17:16,510 - INFO -   Embedding models to process: 1
2025-11-14 23:17:16,511 - INFO -   Embedding storage directory: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews
2025-11-14 23:17:16,511 - INFO -   Embeddings will be loaded on-demand (one model at a time mode)
2025-11-14 23:17:16,511 - INFO - 
[STEP 8] Starting optimization for all embedding models...
2025-11-14 23:17:16,511 - INFO -   Total embedding models to optimize: 1
2025-11-14 23:17:16,511 - INFO -   Mode: Process one model at a time (memory-efficient)
2025-11-14 23:17:16,512 - INFO - 
================================================================================
2025-11-14 23:17:16,512 - INFO - Processing embedding model 1/1: sentence-transformers/paraphrase-mpnet-base-v2
2025-11-14 23:17:16,512 - INFO - ================================================================================
2025-11-14 23:17:16,512 - INFO -   Loading embeddings for this model only...
2025-11-14 23:17:16,512 - INFO -     Loading from: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/embeddings_sentence-transformers_paraphrase-mpnet-base-v2.pkl
2025-11-14 23:17:16,552 - INFO -   Instantiating BERTopicOctisModelWithEmbeddings...
2025-11-14 23:17:16,552 - INFO -   ✓ Model instance created
2025-11-14 23:17:16,552 - INFO -   Starting hyperparameter optimization for sentence-transformers/paraphrase-mpnet-base-v2...
2025-11-14 23:17:16,552 - INFO - 
[STEP 7] Setting up hyperparameter optimization for: sentence-transformers/paraphrase-mpnet-base-v2
2025-11-14 23:17:16,553 - INFO -   Building search space from configuration...
2025-11-14 23:17:16,553 - INFO - Building search space from configuration...
2025-11-14 23:17:16,555 - INFO -   umap__n_neighbors: Integer(10, 100)
2025-11-14 23:17:16,557 - INFO -   umap__n_components: Integer(2, 20)
2025-11-14 23:17:16,561 - INFO -   umap__metric: Categorical(3 values)
2025-11-14 23:17:16,563 - INFO -   hdbscan__min_cluster_size: Integer(20, 300)
2025-11-14 23:17:16,565 - INFO -   hdbscan__min_samples: Integer(5, 300)
2025-11-14 23:17:16,568 - INFO -   hdbscan__metric: Categorical(3 values)
2025-11-14 23:17:16,570 - INFO -   bertopic__top_n_words: Integer(8, 25)
2025-11-14 23:17:16,573 - INFO -   bertopic__n_gram_range: Categorical(3 values) - stored as strings, will convert to tuples
2025-11-14 23:17:16,575 - INFO -   bertopic__min_topic_size: Integer(50, 500)
2025-11-14 23:17:16,577 - INFO -   bertopic__nr_topics: Integer(50, 300)
2025-11-14 23:17:16,581 - INFO -   bertopic__low_memory: Categorical(2 values)
2025-11-14 23:17:16,583 - INFO -   vectorizer__min_df: Real(0.001, 0.01) [default]
2025-11-14 23:17:16,583 - INFO - ✓ Search space built with 12 parameters
2025-11-14 23:17:16,583 - INFO -   Search space contains 12 parameters:
2025-11-14 23:17:16,584 - INFO -     - bertopic__low_memory
2025-11-14 23:17:16,584 - INFO -     - bertopic__min_topic_size
2025-11-14 23:17:16,584 - INFO -     - bertopic__n_gram_range
2025-11-14 23:17:16,584 - INFO -     - bertopic__nr_topics
2025-11-14 23:17:16,584 - INFO -     - bertopic__top_n_words
2025-11-14 23:17:16,584 - INFO -     - hdbscan__metric
2025-11-14 23:17:16,584 - INFO -     - hdbscan__min_cluster_size
2025-11-14 23:17:16,584 - INFO -     - hdbscan__min_samples
2025-11-14 23:17:16,584 - INFO -     - umap__metric
2025-11-14 23:17:16,584 - INFO -     - umap__n_components
2025-11-14 23:17:16,584 - INFO -     - umap__n_neighbors
2025-11-14 23:17:16,584 - INFO -     - vectorizer__min_df
2025-11-14 23:17:16,584 - INFO -   Optimization runs: 4 (overridden by --max-optimization-runs)
2025-11-14 23:17:16,584 - INFO -   Model runs per configuration: 1
2025-11-14 23:17:16,585 - INFO -   Top-k for metrics: 10
2025-11-14 23:17:16,585 - INFO -   Filtering empty documents for coherence calculation...
2025-11-14 23:17:16,587 - INFO -   Documents for coherence: 9,999
2025-11-14 23:17:16,587 - INFO -   Initializing evaluation metrics...
2025-11-14 23:17:16,587 - INFO -     Coherence metric: c_v (topk=10)
2025-11-14 23:17:16,588 - INFO - adding document #0 to Dictionary<0 unique tokens: []>
2025-11-14 23:17:17,236 - INFO - built Dictionary<18815 unique tokens: ['be', 'higher.', 'rating', 'should', 'the']...> from 9999 documents (total 157174 corpus positions)
2025-11-14 23:17:17,248 - INFO - Dictionary lifecycle event {'msg': "built Dictionary<18815 unique tokens: ['be', 'higher.', 'rating', 'should', 'the']...> from 9999 documents (total 157174 corpus positions)", 'datetime': '2025-11-14T23:17:17.237195', 'gensim': '4.4.0', 'python': '3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]', 'platform': 'Linux-6.14.0-115036-tuxedo-x86_64-with-glibc2.39', 'event': 'created'}
2025-11-14 23:17:17,248 - INFO -     Diversity metric: TopicDiversity (topk=10)
2025-11-14 23:17:17,248 - INFO -   ✓ Metrics initialized
2025-11-14 23:17:17,248 - INFO -   Creating optimizer instance...
2025-11-14 23:17:17,248 - INFO -   ✓ Optimizer created
2025-11-14 23:17:17,249 - INFO -   Results path: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/
2025-11-14 23:17:17,249 - INFO -   Result file: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/result.json
2025-11-14 23:17:17,249 - INFO - 
  No existing results found
2025-11-14 23:17:17,249 - INFO -   Starting new optimization
2025-11-14 23:17:17,249 - INFO -   Results will be saved to: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/
2025-11-14 23:17:17,249 - INFO -   Optimization settings:
2025-11-14 23:17:17,249 - INFO -     - Number of calls: 4
2025-11-14 23:17:17,249 - INFO -     - Model runs per config: 1
2025-11-14 23:17:17,249 - INFO -     - Primary metric: Coherence (c_v)
2025-11-14 23:17:17,249 - INFO -     - Extra metrics: TopicDiversity
2025-11-14 23:17:17,250 - INFO -     - Save models: True
2025-11-14 23:17:17,334 - INFO - 
================================================================================
2025-11-14 23:17:17,334 - INFO - Training #1
2025-11-14 23:17:17,334 - INFO - Embedding model: sentence-transformers/paraphrase-mpnet-base-v2
2025-11-14 23:17:17,334 - INFO - ================================================================================
2025-11-14 23:17:17,335 - INFO - Results directory: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2
2025-11-14 23:17:17,335 - INFO - Results file: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/result.json
2025-11-14 23:17:17,335 - INFO - Results CSV: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/results.csv
2025-11-14 23:17:17,336 - INFO - 
[Training] Setting hyperparameters...
2025-11-14 23:17:17,336 - INFO -   Received 12 hyperparameters from optimizer
2025-11-14 23:17:17,336 - INFO -   Hyperparameters after merging:
2025-11-14 23:17:17,336 - INFO -     umap:
2025-11-14 23:17:17,337 - INFO -       n_neighbors: 87
2025-11-14 23:17:17,337 - INFO -       n_components: 16
2025-11-14 23:17:17,337 - INFO -       min_dist: 0.05
2025-11-14 23:17:17,337 - INFO -       metric: manhattan
2025-11-14 23:17:17,337 - INFO -       random_state: 42
2025-11-14 23:17:17,337 - INFO -     hdbscan:
2025-11-14 23:17:17,337 - INFO -       min_cluster_size: 71
2025-11-14 23:17:17,337 - INFO -       metric: cosine
2025-11-14 23:17:17,338 - INFO -       cluster_selection_method: eom
2025-11-14 23:17:17,338 - INFO -       prediction_data: True
2025-11-14 23:17:17,338 - INFO -       gen_min_span_tree: True
2025-11-14 23:17:17,338 - INFO -       min_samples: 212
2025-11-14 23:17:17,338 - INFO -     vectorizer:
2025-11-14 23:17:17,338 - INFO -       stop_words: english
2025-11-14 23:17:17,338 - INFO -       min_df: 0.0056575194569230425
2025-11-14 23:17:17,338 - INFO -       ngram_range: (1, 1)
2025-11-14 23:17:17,338 - INFO -     tfdf_vectorizer:
2025-11-14 23:17:17,338 - INFO -       reduce_frequent_words: True
2025-11-14 23:17:17,338 - INFO -       bm25_weighting: True
2025-11-14 23:17:17,338 - INFO -     bertopic:
2025-11-14 23:17:17,338 - INFO -       language: english
2025-11-14 23:17:17,338 - INFO -       top_n_words: 18
2025-11-14 23:17:17,338 - INFO -       n_gram_range: (1, 3)
2025-11-14 23:17:17,339 - INFO -       min_topic_size: 359
2025-11-14 23:17:17,339 - INFO -       nr_topics: 99
2025-11-14 23:17:17,339 - INFO -       low_memory: False
2025-11-14 23:17:17,339 - INFO -       calculate_probabilities: True
2025-11-14 23:17:17,339 - INFO -       verbose: True
2025-11-14 23:17:17,339 - WARNING -   ⚠ Constraint violation: min_samples (212) > min_cluster_size (71)
2025-11-14 23:17:17,339 - INFO -   Enforcing constraint: setting min_samples = min_cluster_size = 71
2025-11-14 23:17:17,339 - INFO -   ✓ Constraint enforced
2025-11-14 23:17:17,341 - INFO - 
[Training] Initializing pipeline components...
2025-11-14 23:17:17,341 - INFO -   Creating UMAP model...
2025-11-14 23:17:17,341 - INFO -     Parameters: {'n_neighbors': 87, 'n_components': 16, 'min_dist': 0.05, 'metric': 'manhattan', 'random_state': 42}
2025-11-14 23:17:17,341 - INFO -     Using GPU version (cuML)
2025-11-14 23:17:17,344 - INFO -     ✓ UMAP model created
2025-11-14 23:17:17,344 - INFO -   Creating HDBSCAN model...
2025-11-14 23:17:17,345 - INFO -     Parameters: {'min_cluster_size': 71, 'metric': 'cosine', 'cluster_selection_method': 'eom', 'prediction_data': True, 'gen_min_span_tree': True, 'min_samples': 71}
2025-11-14 23:17:17,345 - INFO -     Using GPU version (cuML)
2025-11-14 23:17:17,345 - INFO -     ✓ HDBSCAN model created
2025-11-14 23:17:17,345 - INFO -   Creating CountVectorizer...
2025-11-14 23:17:17,345 - INFO -     Parameters: {'stop_words': 'english', 'min_df': 0.0056575194569230425, 'ngram_range': (1, 1)}
2025-11-14 23:17:17,345 - INFO -     ✓ CountVectorizer created
2025-11-14 23:17:17,345 - INFO -   Creating ClassTfidfTransformer...
2025-11-14 23:17:17,345 - INFO -     Parameters: {'reduce_frequent_words': True, 'bm25_weighting': True}
2025-11-14 23:17:17,345 - INFO -     ✓ ClassTfidfTransformer created
2025-11-14 23:17:17,346 - INFO -   Creating BERTopic model...
2025-11-14 23:17:17,346 - INFO -     BERTopic parameters: {'language': 'english', 'top_n_words': 18, 'n_gram_range': (1, 3), 'min_topic_size': 359, 'nr_topics': 99, 'low_memory': False, 'calculate_probabilities': True, 'verbose': True}
2025-11-14 23:17:17,346 - INFO -     ✓ BERTopic model created
2025-11-14 23:17:17,346 - INFO - 
[Training] Fitting BERTopic model...
2025-11-14 23:17:17,346 - INFO -   Dataset size: 9,999 sentences
2025-11-14 23:17:17,346 - INFO -   Embeddings shape: (9999, 768)
2025-11-14 23:17:17,346 - INFO -   Starting fit_transform...
2025-11-14 23:17:17,359 - BERTopic - Dimensionality - Fitting the dimensionality reduction algorithm
2025-11-14 23:17:23,355 - INFO - 
[STEP 7] Setting up hyperparameter optimization for: sentence-transformers/paraphrase-mpnet-base-v2
2025-11-14 23:17:23,355 - INFO -   Building search space from configuration...
2025-11-14 23:17:23,355 - INFO - Building search space from configuration...
2025-11-14 23:17:23,358 - INFO -   umap__n_neighbors: Integer(10, 100)
2025-11-14 23:17:23,361 - INFO -   umap__n_components: Integer(2, 20)
2025-11-14 23:17:23,364 - INFO -   umap__metric: Categorical(3 values)
2025-11-14 23:17:23,369 - INFO -   hdbscan__min_cluster_size: Integer(20, 300)
2025-11-14 23:17:23,374 - INFO -   hdbscan__min_samples: Integer(5, 300)
2025-11-14 23:17:23,379 - INFO -   hdbscan__metric: Categorical(3 values)
2025-11-14 23:17:23,382 - INFO -   bertopic__top_n_words: Integer(8, 25)
2025-11-14 23:17:23,386 - INFO -   bertopic__n_gram_range: Categorical(3 values) - stored as strings, will convert to tuples
2025-11-14 23:17:23,388 - INFO -   bertopic__min_topic_size: Integer(50, 500)
2025-11-14 23:17:23,392 - INFO -   bertopic__nr_topics: Integer(50, 300)
2025-11-14 23:17:23,396 - INFO -   bertopic__low_memory: Categorical(2 values)
2025-11-14 23:17:23,399 - INFO -   vectorizer__min_df: Real(0.001, 0.01) [default]
2025-11-14 23:17:23,399 - INFO - ✓ Search space built with 12 parameters
2025-11-14 23:17:23,399 - INFO -   Search space contains 12 parameters:
2025-11-14 23:17:23,399 - INFO -     - bertopic__low_memory
2025-11-14 23:17:23,400 - INFO -     - bertopic__min_topic_size
2025-11-14 23:17:23,400 - INFO -     - bertopic__n_gram_range
2025-11-14 23:17:23,400 - INFO -     - bertopic__nr_topics
2025-11-14 23:17:23,400 - INFO -     - bertopic__top_n_words
2025-11-14 23:17:23,400 - INFO -     - hdbscan__metric
2025-11-14 23:17:23,401 - INFO -     - hdbscan__min_cluster_size
2025-11-14 23:17:23,401 - INFO -     - hdbscan__min_samples
2025-11-14 23:17:23,401 - INFO -     - umap__metric
2025-11-14 23:17:23,401 - INFO -     - umap__n_components
2025-11-14 23:17:23,401 - INFO -     - umap__n_neighbors
2025-11-14 23:17:23,401 - INFO -     - vectorizer__min_df
2025-11-14 23:17:23,401 - INFO -   Optimization runs: 4 (overridden by --max-optimization-runs)
2025-11-14 23:17:23,402 - INFO -   Model runs per configuration: 1
2025-11-14 23:17:23,402 - INFO -   Top-k for metrics: 10
2025-11-14 23:17:23,402 - INFO -   Filtering empty documents for coherence calculation...
2025-11-14 23:17:23,404 - INFO -   Documents for coherence: 9,999
2025-11-14 23:17:23,404 - INFO -   Initializing evaluation metrics...
2025-11-14 23:17:23,405 - INFO -     Coherence metric: c_v (topk=10)
2025-11-14 23:17:23,405 - INFO - adding document #0 to Dictionary<0 unique tokens: []>
2025-11-14 23:17:24,075 - INFO - built Dictionary<18815 unique tokens: ['be', 'higher.', 'rating', 'should', 'the']...> from 9999 documents (total 157174 corpus positions)
2025-11-14 23:17:24,076 - INFO - Dictionary lifecycle event {'msg': "built Dictionary<18815 unique tokens: ['be', 'higher.', 'rating', 'should', 'the']...> from 9999 documents (total 157174 corpus positions)", 'datetime': '2025-11-14T23:17:24.076195', 'gensim': '4.4.0', 'python': '3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]', 'platform': 'Linux-6.14.0-115036-tuxedo-x86_64-with-glibc2.39', 'event': 'created'}
2025-11-14 23:17:24,076 - INFO -     Diversity metric: TopicDiversity (topk=10)
2025-11-14 23:17:24,076 - INFO -   ✓ Metrics initialized
2025-11-14 23:17:24,076 - INFO -   Creating optimizer instance...
2025-11-14 23:17:24,076 - INFO -   ✓ Optimizer created
2025-11-14 23:17:24,077 - INFO -   Results path: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/
2025-11-14 23:17:24,077 - INFO -   Result file: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/result.json
2025-11-14 23:17:24,077 - INFO - 
  Found existing optimization results
2025-11-14 23:17:24,077 - INFO -   Resuming optimization from: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/result.json
2025-11-14 23:17:24,077 - INFO -   Result file size: 0.0 MB
2025-11-14 23:17:24,077 - WARNING - Corrupted result.json file detected: Expecting value: line 1 column 2150 (char 2149)
2025-11-14 23:17:24,078 - WARNING - Removing corrupted file: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/result.json
2025-11-14 23:17:24,078 - INFO - Corrupted file removed. Optimization will start fresh.
2025-11-14 23:17:29,083 - INFO - 
[STEP 7] Setting up hyperparameter optimization for: sentence-transformers/paraphrase-mpnet-base-v2
2025-11-14 23:17:29,083 - INFO -   Building search space from configuration...
2025-11-14 23:17:29,083 - INFO - Building search space from configuration...
2025-11-14 23:17:29,086 - INFO -   umap__n_neighbors: Integer(10, 100)
2025-11-14 23:17:29,088 - INFO -   umap__n_components: Integer(2, 20)
2025-11-14 23:17:29,093 - INFO -   umap__metric: Categorical(3 values)
2025-11-14 23:17:29,096 - INFO -   hdbscan__min_cluster_size: Integer(20, 300)
2025-11-14 23:17:29,098 - INFO -   hdbscan__min_samples: Integer(5, 300)
2025-11-14 23:17:29,101 - INFO -   hdbscan__metric: Categorical(3 values)
2025-11-14 23:17:29,103 - INFO -   bertopic__top_n_words: Integer(8, 25)
2025-11-14 23:17:29,106 - INFO -   bertopic__n_gram_range: Categorical(3 values) - stored as strings, will convert to tuples
2025-11-14 23:17:29,109 - INFO -   bertopic__min_topic_size: Integer(50, 500)
2025-11-14 23:17:29,110 - INFO -   bertopic__nr_topics: Integer(50, 300)
2025-11-14 23:17:29,113 - INFO -   bertopic__low_memory: Categorical(2 values)
2025-11-14 23:17:29,116 - INFO -   vectorizer__min_df: Real(0.001, 0.01) [default]
2025-11-14 23:17:29,116 - INFO - ✓ Search space built with 12 parameters
2025-11-14 23:17:29,116 - INFO -   Search space contains 12 parameters:
2025-11-14 23:17:29,116 - INFO -     - bertopic__low_memory
2025-11-14 23:17:29,116 - INFO -     - bertopic__min_topic_size
2025-11-14 23:17:29,116 - INFO -     - bertopic__n_gram_range
2025-11-14 23:17:29,116 - INFO -     - bertopic__nr_topics
2025-11-14 23:17:29,116 - INFO -     - bertopic__top_n_words
2025-11-14 23:17:29,117 - INFO -     - hdbscan__metric
2025-11-14 23:17:29,117 - INFO -     - hdbscan__min_cluster_size
2025-11-14 23:17:29,117 - INFO -     - hdbscan__min_samples
2025-11-14 23:17:29,117 - INFO -     - umap__metric
2025-11-14 23:17:29,117 - INFO -     - umap__n_components
2025-11-14 23:17:29,117 - INFO -     - umap__n_neighbors
2025-11-14 23:17:29,117 - INFO -     - vectorizer__min_df
2025-11-14 23:17:29,118 - INFO -   Optimization runs: 4 (overridden by --max-optimization-runs)
2025-11-14 23:17:29,118 - INFO -   Model runs per configuration: 1
2025-11-14 23:17:29,118 - INFO -   Top-k for metrics: 10
2025-11-14 23:17:29,118 - INFO -   Filtering empty documents for coherence calculation...
2025-11-14 23:17:29,120 - INFO -   Documents for coherence: 9,999
2025-11-14 23:17:29,120 - INFO -   Initializing evaluation metrics...
2025-11-14 23:17:29,120 - INFO -     Coherence metric: c_v (topk=10)
2025-11-14 23:17:29,120 - INFO - adding document #0 to Dictionary<0 unique tokens: []>
2025-11-14 23:17:29,790 - INFO - built Dictionary<18815 unique tokens: ['be', 'higher.', 'rating', 'should', 'the']...> from 9999 documents (total 157174 corpus positions)
2025-11-14 23:17:29,791 - INFO - Dictionary lifecycle event {'msg': "built Dictionary<18815 unique tokens: ['be', 'higher.', 'rating', 'should', 'the']...> from 9999 documents (total 157174 corpus positions)", 'datetime': '2025-11-14T23:17:29.791015', 'gensim': '4.4.0', 'python': '3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0]', 'platform': 'Linux-6.14.0-115036-tuxedo-x86_64-with-glibc2.39', 'event': 'created'}
2025-11-14 23:17:29,791 - INFO -     Diversity metric: TopicDiversity (topk=10)
2025-11-14 23:17:29,791 - INFO -   ✓ Metrics initialized
2025-11-14 23:17:29,791 - INFO -   Creating optimizer instance...
2025-11-14 23:17:29,791 - INFO -   ✓ Optimizer created
2025-11-14 23:17:29,791 - INFO -   Results path: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/
2025-11-14 23:17:29,791 - INFO -   Result file: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/result.json
2025-11-14 23:17:29,792 - INFO - 
  No existing results found
2025-11-14 23:17:29,792 - INFO -   Starting new optimization
2025-11-14 23:17:29,792 - INFO -   Results will be saved to: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/
2025-11-14 23:17:29,792 - INFO -   Optimization settings:
2025-11-14 23:17:29,792 - INFO -     - Number of calls: 4
2025-11-14 23:17:29,792 - INFO -     - Model runs per config: 1
2025-11-14 23:17:29,792 - INFO -     - Primary metric: Coherence (c_v)
2025-11-14 23:17:29,792 - INFO -     - Extra metrics: TopicDiversity
2025-11-14 23:17:29,792 - INFO -     - Save models: True
2025-11-14 23:17:29,874 - INFO - 
================================================================================
2025-11-14 23:17:29,875 - INFO - Training #2
2025-11-14 23:17:29,875 - INFO - Embedding model: sentence-transformers/paraphrase-mpnet-base-v2
2025-11-14 23:17:29,875 - INFO - ================================================================================
2025-11-14 23:17:29,875 - INFO - Results directory: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2
2025-11-14 23:17:29,875 - INFO - Results file: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/result.json
2025-11-14 23:17:29,875 - INFO - Results CSV: /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/optimization_results/sentence-transformers/paraphrase-mpnet-base-v2/results.csv
2025-11-14 23:17:29,876 - INFO - 
[Training] Setting hyperparameters...
2025-11-14 23:17:29,876 - INFO -   Received 12 hyperparameters from optimizer
2025-11-14 23:17:29,876 - INFO -   Hyperparameters after merging:
2025-11-14 23:17:29,876 - INFO -     umap:
2025-11-14 23:17:29,876 - INFO -       n_neighbors: 87
2025-11-14 23:17:29,876 - INFO -       n_components: 16
2025-11-14 23:17:29,877 - INFO -       min_dist: 0.05
2025-11-14 23:17:29,877 - INFO -       metric: manhattan
2025-11-14 23:17:29,877 - INFO -       random_state: 42
2025-11-14 23:17:29,877 - INFO -     hdbscan:
2025-11-14 23:17:29,877 - INFO -       min_cluster_size: 71
2025-11-14 23:17:29,877 - INFO -       metric: cosine
2025-11-14 23:17:29,877 - INFO -       cluster_selection_method: eom
2025-11-14 23:17:29,877 - INFO -       prediction_data: True
2025-11-14 23:17:29,878 - INFO -       gen_min_span_tree: True
2025-11-14 23:17:29,878 - INFO -       min_samples: 212
2025-11-14 23:17:29,878 - INFO -     vectorizer:
2025-11-14 23:17:29,878 - INFO -       stop_words: english
2025-11-14 23:17:29,878 - INFO -       min_df: 0.0056575194569230425
2025-11-14 23:17:29,878 - INFO -       ngram_range: (1, 1)
2025-11-14 23:17:29,878 - INFO -     tfdf_vectorizer:
2025-11-14 23:17:29,878 - INFO -       reduce_frequent_words: True
2025-11-14 23:17:29,878 - INFO -       bm25_weighting: True
2025-11-14 23:17:29,878 - INFO -     bertopic:
2025-11-14 23:17:29,878 - INFO -       language: english
2025-11-14 23:17:29,878 - INFO -       top_n_words: 18
2025-11-14 23:17:29,879 - INFO -       n_gram_range: (1, 3)
2025-11-14 23:17:29,879 - INFO -       min_topic_size: 359
2025-11-14 23:17:29,879 - INFO -       nr_topics: 99
2025-11-14 23:17:29,879 - INFO -       low_memory: False
2025-11-14 23:17:29,879 - INFO -       calculate_probabilities: True
2025-11-14 23:17:29,879 - INFO -       verbose: True
2025-11-14 23:17:29,879 - WARNING -   ⚠ Constraint violation: min_samples (212) > min_cluster_size (71)
2025-11-14 23:17:29,879 - INFO -   Enforcing constraint: setting min_samples = min_cluster_size = 71
2025-11-14 23:17:29,879 - INFO -   ✓ Constraint enforced
2025-11-14 23:17:29,880 - INFO - 
[Training] Initializing pipeline components...
2025-11-14 23:17:29,881 - INFO -   Creating UMAP model...
2025-11-14 23:17:29,881 - INFO -     Parameters: {'n_neighbors': 87, 'n_components': 16, 'min_dist': 0.05, 'metric': 'manhattan', 'random_state': 42}
2025-11-14 23:17:29,881 - INFO -     Using GPU version (cuML)
2025-11-14 23:17:29,884 - INFO -     ✓ UMAP model created
2025-11-14 23:17:29,884 - INFO -   Creating HDBSCAN model...
2025-11-14 23:17:29,885 - INFO -     Parameters: {'min_cluster_size': 71, 'metric': 'cosine', 'cluster_selection_method': 'eom', 'prediction_data': True, 'gen_min_span_tree': True, 'min_samples': 71}
2025-11-14 23:17:29,885 - INFO -     Using GPU version (cuML)
2025-11-14 23:17:29,885 - INFO -     ✓ HDBSCAN model created
2025-11-14 23:17:29,885 - INFO -   Creating CountVectorizer...
2025-11-14 23:17:29,885 - INFO -     Parameters: {'stop_words': 'english', 'min_df': 0.0056575194569230425, 'ngram_range': (1, 1)}
2025-11-14 23:17:29,885 - INFO -     ✓ CountVectorizer created
2025-11-14 23:17:29,885 - INFO -   Creating ClassTfidfTransformer...
2025-11-14 23:17:29,885 - INFO -     Parameters: {'reduce_frequent_words': True, 'bm25_weighting': True}
2025-11-14 23:17:29,885 - INFO -     ✓ ClassTfidfTransformer created
2025-11-14 23:17:29,886 - INFO -   Creating BERTopic model...
2025-11-14 23:17:29,886 - INFO -     BERTopic parameters: {'language': 'english', 'top_n_words': 18, 'n_gram_range': (1, 3), 'min_topic_size': 359, 'nr_topics': 99, 'low_memory': False, 'calculate_probabilities': True, 'verbose': True}
2025-11-14 23:17:29,886 - INFO -     ✓ BERTopic model created
2025-11-14 23:17:29,886 - INFO - 
[Training] Fitting BERTopic model...
2025-11-14 23:17:29,886 - INFO -   Dataset size: 9,999 sentences
2025-11-14 23:17:29,887 - INFO -   Embeddings shape: (9999, 768)
2025-11-14 23:17:29,887 - INFO -   Starting fit_transform...
2025-11-14 23:17:29,896 - BERTopic - Dimensionality - Fitting the dimensionality reduction algorithm
Embeddings loaded from /home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/data/interim/octis_reviews/embeddings_sentence-transformers_paraphrase-mpnet-base-v2.pkl
Attempt 1 of 3
Current call:  0
Training with parameters:
{'bertopic': {'calculate_probabilities': True,
              'language': 'english',
              'low_memory': False,
              'min_topic_size': 359,
              'n_gram_range': (1, 3),
              'nr_topics': 99,
              'top_n_words': 18,
              'verbose': True},
 'hdbscan': {'cluster_selection_method': 'eom',
             'gen_min_span_tree': True,
             'metric': 'cosine',
             'min_cluster_size': 71,
             'min_samples': 71,
             'prediction_data': True},
 'tfdf_vectorizer': {'bm25_weighting': True, 'reduce_frequent_words': True},
 'umap': {'metric': 'manhattan',
          'min_dist': 0.05,
          'n_components': 16,
          'n_neighbors': 87,
          'random_state': 42},
 'vectorizer': {'min_df': 0.0056575194569230425,
                'ngram_range': (1, 1),
                'stop_words': 'english'}}
[2025-11-14 23:17:17.344] [CUML] [info] build_algo set to brute_force_knn because random_state is given
>>>>>>>>>>>>>>>>>>>>>****TRAINING ERROR****<<<<<<<<<<<<<<<<<<<
Hyperparameters: {'bertopic__low_memory': False, 'bertopic__min_topic_size': 359, 'bertopic__n_gram_range': '(1, 3)', 'bertopic__nr_topics': 99, 'bertopic__top_n_words': 18, 'hdbscan__metric': 'cosine', 'hdbscan__min_cluster_size': 71, 'hdbscan__min_samples': 212, 'umap__metric': 'manhattan', 'umap__n_components': 16, 'umap__n_neighbors': 87, 'vectorizer__min_df': 0.0056575194569230425}
Exception: Argument 'metric' has incorrect type (expected str, got numpy.str_)
==================================================================
An error occurred during optimization (Attempt 1):
Traceback (most recent call last):
  File "/home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/src/reviews_analysis/BERTopic_OCTIS/bertopic_plus_octis.py", line 1141, in optimize_with_restart
    def optimize_with_restart(model, embedding_model_name, dataset_as_list_of_lists, embedding_file_path=None, max_retries=3, delay=5):
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/src/reviews_analysis/BERTopic_OCTIS/bertopic_plus_octis.py", line 1097, in optimize_hyperparameters
    except Exception as remove_err:
              ^^^^^^^^^^^^^^^^^^^^^
  File "/home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/src/reviews_analysis/BERTopic_OCTIS/optimizer.py", line 184, in optimize
    results = self._optimization_loop(opt)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/src/reviews_analysis/BERTopic_OCTIS/optimizer.py", line 347, in _optimization_loop
    results.save(name_json)
  File "/home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/romance-novel-nlp-research/.venv/lib/python3.12/site-packages/octis/optimization/optimizer_evaluation.py", line 132, in save
    json.dump(self.info, fp)
  File "/usr/lib/python3.12/json/__init__.py", line 179, in dump
    for chunk in iterable:
  File "/usr/lib/python3.12/json/encoder.py", line 432, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "/usr/lib/python3.12/json/encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "/usr/lib/python3.12/json/encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "/usr/lib/python3.12/json/encoder.py", line 326, in _iterencode_list
    yield from chunks
  File "/usr/lib/python3.12/json/encoder.py", line 439, in _iterencode
    o = _default(o)
        ^^^^^^^^^^^
  File "/usr/lib/python3.12/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type bool_ is not JSON serializable

Restarting in 5 seconds...
Attempt 2 of 3
An error occurred during optimization (Attempt 2):
Traceback (most recent call last):
  File "/home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/src/reviews_analysis/BERTopic_OCTIS/optimizer.py", line 413, in _restore_parameters
    optimization_object = json.load(file)
                          ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/__init__.py", line 293, in load
    return loads(fp.read(),
           ^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 2150 (char 2149)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/src/reviews_analysis/BERTopic_OCTIS/bertopic_plus_octis.py", line 1141, in optimize_with_restart
    def optimize_with_restart(model, embedding_model_name, dataset_as_list_of_lists, embedding_file_path=None, max_retries=3, delay=5):
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/src/reviews_analysis/BERTopic_OCTIS/bertopic_plus_octis.py", line 1084, in optimize_hyperparameters
    try:
         
  File "/home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/src/reviews_analysis/BERTopic_OCTIS/optimizer.py", line 201, in resume_optimization
    res, opt = self._restore_parameters(name_path, model)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/src/reviews_analysis/BERTopic_OCTIS/optimizer.py", line 426, in _restore_parameters
    raise ValueError(f"Cannot resume optimization: result.json file is corrupted. File has been removed. Please start a new optimization.") from e
ValueError: Cannot resume optimization: result.json file is corrupted. File has been removed. Please start a new optimization.

Restarting in 5 seconds...
Attempt 3 of 3
Current call:  0
Training with parameters:
{'bertopic': {'calculate_probabilities': True,
              'language': 'english',
              'low_memory': False,
              'min_topic_size': 359,
              'n_gram_range': (1, 3),
              'nr_topics': 99,
              'top_n_words': 18,
              'verbose': True},
 'hdbscan': {'cluster_selection_method': 'eom',
             'gen_min_span_tree': True,
             'metric': 'cosine',
             'min_cluster_size': 71,
             'min_samples': 71,
             'prediction_data': True},
 'tfdf_vectorizer': {'bm25_weighting': True, 'reduce_frequent_words': True},
 'umap': {'metric': 'manhattan',
          'min_dist': 0.05,
          'n_components': 16,
          'n_neighbors': 87,
          'random_state': 42},
 'vectorizer': {'min_df': 0.0056575194569230425,
                'ngram_range': (1, 1),
                'stop_words': 'english'}}
[2025-11-14 23:17:29.884] [CUML] [info] build_algo set to brute_force_knn because random_state is given
>>>>>>>>>>>>>>>>>>>>>****TRAINING ERROR****<<<<<<<<<<<<<<<<<<<
Hyperparameters: 2025-11-14 23:17:35,691 - INFO -   ✓ Optimization completed for sentence-transformers/paraphrase-mpnet-base-v2
2025-11-14 23:17:35,692 - INFO -   Cleaning up model instance...
2025-11-14 23:17:35,692 - INFO -   Clearing embeddings from memory...
2025-11-14 23:17:36,436 - INFO -   ✓ Cleanup completed
2025-11-14 23:17:36,437 - ERROR - ================================================================================
2025-11-14 23:17:36,437 - ERROR - FATAL ERROR in optimization pipeline
2025-11-14 23:17:36,438 - ERROR - ================================================================================
2025-11-14 23:17:36,438 - ERROR - Exception type: JSONDecodeError
2025-11-14 23:17:36,438 - ERROR - Exception message: Expecting value: line 1 column 2150 (char 2149)
2025-11-14 23:17:36,438 - ERROR - Full traceback:
Traceback (most recent call last):
  File "/home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/src/reviews_analysis/BERTopic_OCTIS/bertopic_plus_octis.py", line 1238, in <module>
    logger.error(f"\n{'='*80}")
              ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/__init__.py", line 293, in load
    return loads(fp.read(),
           ^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 2150 (char 2149)
{'bertopic__low_memory': False, 'bertopic__min_topic_size': 359, 'bertopic__n_gram_range': '(1, 3)', 'bertopic__nr_topics': 99, 'bertopic__top_n_words': 18, 'hdbscan__metric': 'cosine', 'hdbscan__min_cluster_size': 71, 'hdbscan__min_samples': 212, 'umap__metric': 'manhattan', 'umap__n_components': 16, 'umap__n_neighbors': 87, 'vectorizer__min_df': 0.0056575194569230425}
Exception: Argument 'metric' has incorrect type (expected str, got numpy.str_)
==================================================================
An error occurred during optimization (Attempt 3):
Traceback (most recent call last):
  File "/home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/src/reviews_analysis/BERTopic_OCTIS/bertopic_plus_octis.py", line 1141, in optimize_with_restart
    def optimize_with_restart(model, embedding_model_name, dataset_as_list_of_lists, embedding_file_path=None, max_retries=3, delay=5):
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/src/reviews_analysis/BERTopic_OCTIS/bertopic_plus_octis.py", line 1097, in optimize_hyperparameters
    except Exception as remove_err:
              ^^^^^^^^^^^^^^^^^^^^^
  File "/home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/src/reviews_analysis/BERTopic_OCTIS/optimizer.py", line 184, in optimize
    results = self._optimization_loop(opt)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/src/reviews_analysis/BERTopic_OCTIS/optimizer.py", line 347, in _optimization_loop
    results.save(name_json)
  File "/home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/romance-novel-nlp-research/.venv/lib/python3.12/site-packages/octis/optimization/optimizer_evaluation.py", line 132, in save
    json.dump(self.info, fp)
  File "/usr/lib/python3.12/json/__init__.py", line 179, in dump
    for chunk in iterable:
  File "/usr/lib/python3.12/json/encoder.py", line 432, in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
  File "/usr/lib/python3.12/json/encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "/usr/lib/python3.12/json/encoder.py", line 406, in _iterencode_dict
    yield from chunks
  File "/usr/lib/python3.12/json/encoder.py", line 326, in _iterencode_list
    yield from chunks
  File "/usr/lib/python3.12/json/encoder.py", line 439, in _iterencode
    o = _default(o)
        ^^^^^^^^^^^
  File "/usr/lib/python3.12/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type bool_ is not JSON serializable

Restarting in 5 seconds...
Traceback (most recent call last):
  File "/home/polina/Documents/goodreads_romance_research_cursor/romance_novel_nlp_research/src/reviews_analysis/BERTopic_OCTIS/bertopic_plus_octis.py", line 1238, in <module>
    logger.error(f"\n{'='*80}")
              ^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/__init__.py", line 293, in load
    return loads(fp.read(),
           ^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 2150 (char 2149)
